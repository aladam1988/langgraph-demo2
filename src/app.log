2025-04-04 22:47:36.502 | INFO     | __main__:main:627 - 开始分析数据库...
2025-04-04 22:47:36.502 | INFO     | __main__:main:631 - 数据库路径: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 22:47:36.505 | INFO     | __main__:__init__:114 - 已连接到数据库: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 22:47:36.505 | INFO     | __main__:main:636 - 已初始化数据分析器，连接到数据库: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 22:47:36.512 | INFO     | __main__:main:640 - 已准备数据用于大模型分析
2025-04-04 22:47:36.512 | INFO     | __main__:__init__:411 - 初始化大模型分析器，使用模型: deepseek-chat
2025-04-04 22:47:36.512 | INFO     | __main__:main:644 - 已初始化大模型分析器
2025-04-04 22:47:36.513 | INFO     | __main__:main:647 - 开始使用大模型分析数据...
2025-04-04 22:47:36.513 | INFO     | __main__:analyze_data:423 - 调用大模型API...
2025-04-04 22:47:36.513 | DEBUG    | __main__:analyze_data:448 - API请求: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:47:36.513 | DEBUG    | __main__:analyze_data:449 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:47:36.513 | DEBUG    | __main__:analyze_data:450 - 请求体: {'model': 'deepseek-chat', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和样本数据，提供深入的见解和建议。\n        \n        ## 数据库结构\n        \n## 样本数据\n\n### 表: accounts (前1条记录)\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]\n\n### 表: transactions (前5条记录)\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]\n\n### 表: analysis_results (前1条记录)\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n\n        ## 分析要求\n        \n        请提供以下分析:\n        \n        1. 数据库结构分析：评估表结构设计，包括表关系、主键、外键等\n        2. 数据质量分析：评估数据的完整性、一致性和有效性\n        3. 数据模式和趋势：识别数据中的模式、趋势和异常\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:47:36.671 | ERROR    | __main__:analyze_data:475 - API请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:47:36.671 | ERROR    | __main__:analyze_data:481 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 22:47:36.671 | ERROR    | __main__:main:670 - 大模型分析失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:47:36.672 | INFO     | __main__:main:675 - 开始分析账户 1...
2025-04-04 22:47:36.673 | ERROR    | __main__:generate_transaction_chart:315 - 生成图表时出错: could not convert string to float: '2025-04-03 01:06:58'
2025-04-04 22:47:36.673 | INFO     | __main__:analyze_data:423 - 调用大模型API...
2025-04-04 22:47:36.673 | DEBUG    | __main__:analyze_data:448 - API请求: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:47:36.673 | DEBUG    | __main__:analyze_data:449 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:47:36.673 | DEBUG    | __main__:analyze_data:450 - 请求体: {'model': 'deepseek-chat', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:47:36.810 | ERROR    | __main__:analyze_data:475 - API请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:47:36.810 | ERROR    | __main__:analyze_data:481 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 22:47:36.811 | ERROR    | __main__:main:729 - 账户 1 分析失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:47:36.811 | INFO     | __main__:close:120 - 数据库连接已关闭
2025-04-04 22:47:36.811 | INFO     | __main__:main:742 - 分析完成
2025-04-04 22:49:46.743 | INFO     | __main__:main:627 - 开始分析数据库...
2025-04-04 22:49:46.744 | INFO     | __main__:main:631 - 数据库路径: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 22:49:46.744 | INFO     | __main__:__init__:114 - 已连接到数据库: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 22:49:46.745 | INFO     | __main__:main:636 - 已初始化数据分析器，连接到数据库: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 22:49:46.746 | INFO     | __main__:main:640 - 已准备数据用于大模型分析
2025-04-04 22:49:46.746 | INFO     | __main__:__init__:411 - 初始化大模型分析器，使用模型: deepseek-chat
2025-04-04 22:49:46.746 | INFO     | __main__:main:644 - 已初始化大模型分析器
2025-04-04 22:49:46.747 | INFO     | __main__:main:647 - 开始使用大模型分析数据...
2025-04-04 22:49:46.747 | INFO     | __main__:analyze_data:423 - 调用大模型API...
2025-04-04 22:49:46.747 | DEBUG    | __main__:analyze_data:448 - API请求: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:49:46.747 | DEBUG    | __main__:analyze_data:449 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:49:46.747 | DEBUG    | __main__:analyze_data:450 - 请求体: {'model': 'deepseek-chat', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和样本数据，提供深入的见解和建议。\n        \n        ## 数据库结构\n        \n## 样本数据\n\n### 表: accounts (前1条记录)\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]\n\n### 表: transactions (前5条记录)\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]\n\n### 表: analysis_results (前1条记录)\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n\n        ## 分析要求\n        \n        请提供以下分析:\n        \n        1. 数据库结构分析：评估表结构设计，包括表关系、主键、外键等\n        2. 数据质量分析：评估数据的完整性、一致性和有效性\n        3. 数据模式和趋势：识别数据中的模式、趋势和异常\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:49:46.906 | ERROR    | __main__:analyze_data:475 - API请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:49:46.906 | ERROR    | __main__:analyze_data:481 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 22:49:46.906 | ERROR    | __main__:main:670 - 大模型分析失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:49:46.907 | INFO     | __main__:main:675 - 开始分析账户 1...
2025-04-04 22:49:46.908 | ERROR    | __main__:generate_transaction_chart:315 - 生成图表时出错: could not convert string to float: '2025-04-03 01:06:58'
2025-04-04 22:49:46.908 | INFO     | __main__:analyze_data:423 - 调用大模型API...
2025-04-04 22:49:46.908 | DEBUG    | __main__:analyze_data:448 - API请求: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:49:46.908 | DEBUG    | __main__:analyze_data:449 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:49:46.908 | DEBUG    | __main__:analyze_data:450 - 请求体: {'model': 'deepseek-chat', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:49:47.059 | ERROR    | __main__:analyze_data:475 - API请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:49:47.059 | ERROR    | __main__:analyze_data:481 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 22:49:47.059 | ERROR    | __main__:main:729 - 账户 1 分析失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:49:47.060 | INFO     | __main__:close:120 - 数据库连接已关闭
2025-04-04 22:49:47.060 | INFO     | __main__:main:742 - 分析完成
2025-04-04 22:50:53.720 | INFO     | __main__:main:667 - 开始分析数据库...
2025-04-04 22:50:53.720 | INFO     | __main__:main:671 - 数据库路径: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 22:50:53.723 | INFO     | __main__:__init__:114 - 已连接到数据库: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 22:50:53.724 | INFO     | __main__:main:676 - 已初始化数据分析器，连接到数据库: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 22:50:53.730 | INFO     | __main__:main:680 - 已准备数据用于大模型分析
2025-04-04 22:50:53.731 | INFO     | __main__:__init__:451 - 初始化大模型分析器，使用模型: deepseek-chat
2025-04-04 22:50:53.731 | INFO     | __main__:main:684 - 已初始化大模型分析器
2025-04-04 22:50:53.731 | INFO     | __main__:main:687 - 开始使用大模型分析数据...
2025-04-04 22:50:53.731 | INFO     | __main__:analyze_data:463 - 调用大模型API...
2025-04-04 22:50:53.731 | DEBUG    | __main__:analyze_data:488 - API请求: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:50:53.731 | DEBUG    | __main__:analyze_data:489 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:50:53.731 | DEBUG    | __main__:analyze_data:490 - 请求体: {'model': 'deepseek-chat', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和样本数据，提供深入的见解和建议。\n        \n        ## 数据库结构\n        \n## 样本数据\n\n### 表: accounts (前1条记录)\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]\n\n### 表: transactions (前5条记录)\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]\n\n### 表: analysis_results (前1条记录)\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n\n        ## 分析要求\n        \n        请提供以下分析:\n        \n        1. 数据库结构分析：评估表结构设计，包括表关系、主键、外键等\n        2. 数据质量分析：评估数据的完整性、一致性和有效性\n        3. 数据模式和趋势：识别数据中的模式、趋势和异常\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:50:53.867 | ERROR    | __main__:analyze_data:515 - API请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:50:53.868 | ERROR    | __main__:analyze_data:521 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 22:50:53.868 | ERROR    | __main__:main:710 - 大模型分析失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:50:53.868 | INFO     | __main__:main:715 - 开始分析账户 1...
2025-04-04 22:50:54.184 | INFO     | __main__:analyze_data:463 - 调用大模型API...
2025-04-04 22:50:54.184 | DEBUG    | __main__:analyze_data:488 - API请求: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:50:54.185 | DEBUG    | __main__:analyze_data:489 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:50:54.185 | DEBUG    | __main__:analyze_data:490 - 请求体: {'model': 'deepseek-chat', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:50:54.339 | ERROR    | __main__:analyze_data:515 - API请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:50:54.339 | ERROR    | __main__:analyze_data:521 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 22:50:54.340 | ERROR    | __main__:main:769 - 账户 1 分析失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:50:54.340 | INFO     | __main__:close:120 - 数据库连接已关闭
2025-04-04 22:50:54.340 | INFO     | __main__:main:782 - 分析完成
2025-04-04 22:52:06.804 | INFO     | __main__:main:688 - 开始分析数据库...
2025-04-04 22:52:06.804 | INFO     | __main__:main:692 - 数据库路径: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 22:52:06.805 | INFO     | __main__:__init__:114 - 已连接到数据库: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 22:52:06.805 | INFO     | __main__:main:697 - 已初始化数据分析器，连接到数据库: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 22:52:06.807 | INFO     | __main__:main:701 - 已准备数据用于大模型分析
2025-04-04 22:52:06.807 | INFO     | __main__:__init__:451 - 初始化大模型分析器，使用模型: deepseek-chat
2025-04-04 22:52:06.807 | INFO     | __main__:main:705 - 已初始化大模型分析器
2025-04-04 22:52:06.807 | INFO     | __main__:main:708 - 开始使用大模型分析数据...
2025-04-04 22:52:06.807 | INFO     | __main__:analyze_data:463 - 调用大模型API，模型: deepseek-chat，API基础URL: https://api.siliconflow.cn/v1
2025-04-04 22:52:06.807 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-chat
2025-04-04 22:52:06.808 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:52:06.808 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:52:06.808 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-chat', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和样本数据，提供深入的见解和建议。\n        \n        ## 数据库结构\n        \n## 样本数据\n\n### 表: accounts (前1条记录)\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]\n\n### 表: transactions (前5条记录)\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]\n\n### 表: analysis_results (前1条记录)\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n\n        ## 分析要求\n        \n        请提供以下分析:\n        \n        1. 数据库结构分析：评估表结构设计，包括表关系、主键、外键等\n        2. 数据质量分析：评估数据的完整性、一致性和有效性\n        3. 数据模式和趋势：识别数据中的模式、趋势和异常\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:52:06.979 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-chat 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:52:06.979 | WARNING  | __main__:analyze_data:536 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 22:52:06.979 | INFO     | __main__:analyze_data:543 - 尝试下一个模型...
2025-04-04 22:52:06.979 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-llm
2025-04-04 22:52:06.979 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:52:06.979 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:52:06.980 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-llm', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和样本数据，提供深入的见解和建议。\n        \n        ## 数据库结构\n        \n## 样本数据\n\n### 表: accounts (前1条记录)\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]\n\n### 表: transactions (前5条记录)\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]\n\n### 表: analysis_results (前1条记录)\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n\n        ## 分析要求\n        \n        请提供以下分析:\n        \n        1. 数据库结构分析：评估表结构设计，包括表关系、主键、外键等\n        2. 数据质量分析：评估数据的完整性、一致性和有效性\n        3. 数据模式和趋势：识别数据中的模式、趋势和异常\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:52:07.101 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-llm 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:52:07.101 | WARNING  | __main__:analyze_data:536 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 22:52:07.101 | INFO     | __main__:analyze_data:543 - 尝试下一个模型...
2025-04-04 22:52:07.102 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-chat
2025-04-04 22:52:07.102 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:52:07.102 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:52:07.102 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-chat', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和样本数据，提供深入的见解和建议。\n        \n        ## 数据库结构\n        \n## 样本数据\n\n### 表: accounts (前1条记录)\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]\n\n### 表: transactions (前5条记录)\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]\n\n### 表: analysis_results (前1条记录)\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n\n        ## 分析要求\n        \n        请提供以下分析:\n        \n        1. 数据库结构分析：评估表结构设计，包括表关系、主键、外键等\n        2. 数据质量分析：评估数据的完整性、一致性和有效性\n        3. 数据模式和趋势：识别数据中的模式、趋势和异常\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:52:07.291 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-chat 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:52:07.291 | WARNING  | __main__:analyze_data:536 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 22:52:07.291 | INFO     | __main__:analyze_data:543 - 尝试下一个模型...
2025-04-04 22:52:07.291 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-coder
2025-04-04 22:52:07.291 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:52:07.291 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:52:07.292 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-coder', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和样本数据，提供深入的见解和建议。\n        \n        ## 数据库结构\n        \n## 样本数据\n\n### 表: accounts (前1条记录)\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]\n\n### 表: transactions (前5条记录)\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]\n\n### 表: analysis_results (前1条记录)\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n\n        ## 分析要求\n        \n        请提供以下分析:\n        \n        1. 数据库结构分析：评估表结构设计，包括表关系、主键、外键等\n        2. 数据质量分析：评估数据的完整性、一致性和有效性\n        3. 数据模式和趋势：识别数据中的模式、趋势和异常\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:52:07.488 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-coder 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:52:07.488 | WARNING  | __main__:analyze_data:536 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 22:52:07.488 | INFO     | __main__:analyze_data:543 - 尝试下一个模型...
2025-04-04 22:52:07.488 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-v2
2025-04-04 22:52:07.488 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:52:07.488 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:52:07.488 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-v2', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和样本数据，提供深入的见解和建议。\n        \n        ## 数据库结构\n        \n## 样本数据\n\n### 表: accounts (前1条记录)\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]\n\n### 表: transactions (前5条记录)\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]\n\n### 表: analysis_results (前1条记录)\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n\n        ## 分析要求\n        \n        请提供以下分析:\n        \n        1. 数据库结构分析：评估表结构设计，包括表关系、主键、外键等\n        2. 数据质量分析：评估数据的完整性、一致性和有效性\n        3. 数据模式和趋势：识别数据中的模式、趋势和异常\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:52:07.619 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-v2 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:52:07.619 | WARNING  | __main__:analyze_data:536 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 22:52:07.619 | ERROR    | __main__:analyze_data:547 - 所有模型尝试都失败，生成模拟分析结果
2025-04-04 22:52:07.619 | ERROR    | __main__:main:731 - 大模型分析失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:52:07.620 | INFO     | __main__:main:736 - 开始分析账户 1...
2025-04-04 22:52:07.949 | INFO     | __main__:analyze_data:463 - 调用大模型API，模型: deepseek-chat，API基础URL: https://api.siliconflow.cn/v1
2025-04-04 22:52:07.949 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-chat
2025-04-04 22:52:07.950 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:52:07.950 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:52:07.950 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-chat', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:52:08.110 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-chat 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:52:08.111 | WARNING  | __main__:analyze_data:536 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 22:52:08.111 | INFO     | __main__:analyze_data:543 - 尝试下一个模型...
2025-04-04 22:52:08.111 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-llm
2025-04-04 22:52:08.111 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:52:08.111 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:52:08.111 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-llm', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:52:08.229 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-llm 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:52:08.229 | WARNING  | __main__:analyze_data:536 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 22:52:08.229 | INFO     | __main__:analyze_data:543 - 尝试下一个模型...
2025-04-04 22:52:08.229 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-chat
2025-04-04 22:52:08.229 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:52:08.229 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:52:08.229 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-chat', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:52:08.391 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-chat 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:52:08.391 | WARNING  | __main__:analyze_data:536 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 22:52:08.392 | INFO     | __main__:analyze_data:543 - 尝试下一个模型...
2025-04-04 22:52:08.392 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-coder
2025-04-04 22:52:08.392 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:52:08.392 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:52:08.392 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-coder', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:52:08.583 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-coder 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:52:08.583 | WARNING  | __main__:analyze_data:536 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 22:52:08.583 | INFO     | __main__:analyze_data:543 - 尝试下一个模型...
2025-04-04 22:52:08.584 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-v2
2025-04-04 22:52:08.584 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:52:08.584 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:52:08.584 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-v2', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:52:08.721 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-v2 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:52:08.721 | WARNING  | __main__:analyze_data:536 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 22:52:08.721 | ERROR    | __main__:analyze_data:547 - 所有模型尝试都失败，生成模拟分析结果
2025-04-04 22:52:08.721 | ERROR    | __main__:main:790 - 账户 1 分析失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:52:08.722 | INFO     | __main__:close:120 - 数据库连接已关闭
2025-04-04 22:52:08.722 | INFO     | __main__:main:803 - 分析完成
2025-04-04 22:53:40.598 | INFO     | __main__:main:688 - 开始分析数据库...
2025-04-04 22:53:40.598 | INFO     | __main__:main:692 - 数据库路径: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 22:53:40.599 | INFO     | __main__:__init__:114 - 已连接到数据库: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 22:53:40.599 | INFO     | __main__:main:697 - 已初始化数据分析器，连接到数据库: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 22:53:40.600 | INFO     | __main__:main:701 - 已准备数据用于大模型分析
2025-04-04 22:53:40.600 | INFO     | __main__:__init__:451 - 初始化大模型分析器，使用模型: deepseek-chat
2025-04-04 22:53:40.600 | INFO     | __main__:main:705 - 已初始化大模型分析器
2025-04-04 22:53:40.601 | INFO     | __main__:main:708 - 开始使用大模型分析数据...
2025-04-04 22:53:40.601 | INFO     | __main__:analyze_data:463 - 调用大模型API，模型: deepseek-chat，API基础URL: https://api.siliconflow.cn/v1
2025-04-04 22:53:40.601 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-ai/DeepSeek-R1
2025-04-04 22:53:40.601 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:53:40.601 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:53:40.601 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-ai/DeepSeek-R1', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和样本数据，提供深入的见解和建议。\n        \n        ## 数据库结构\n        \n## 样本数据\n\n### 表: accounts (前1条记录)\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]\n\n### 表: transactions (前5条记录)\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]\n\n### 表: analysis_results (前1条记录)\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n\n        ## 分析要求\n        \n        请提供以下分析:\n        \n        1. 数据库结构分析：评估表结构设计，包括表关系、主键、外键等\n        2. 数据质量分析：评估数据的完整性、一致性和有效性\n        3. 数据模式和趋势：识别数据中的模式、趋势和异常\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:54:40.697 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-ai/DeepSeek-R1 请求失败: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Read timed out. (read timeout=60)
2025-04-04 22:54:40.698 | INFO     | __main__:analyze_data:543 - 尝试下一个模型...
2025-04-04 22:54:40.698 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-ai/DeepSeek-R1-Distill-Llama-70B
2025-04-04 22:54:40.698 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:54:40.698 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:54:40.698 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-ai/DeepSeek-R1-Distill-Llama-70B', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和样本数据，提供深入的见解和建议。\n        \n        ## 数据库结构\n        \n## 样本数据\n\n### 表: accounts (前1条记录)\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]\n\n### 表: transactions (前5条记录)\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]\n\n### 表: analysis_results (前1条记录)\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n\n        ## 分析要求\n        \n        请提供以下分析:\n        \n        1. 数据库结构分析：评估表结构设计，包括表关系、主键、外键等\n        2. 数据质量分析：评估数据的完整性、一致性和有效性\n        3. 数据模式和趋势：识别数据中的模式、趋势和异常\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:55:40.809 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-ai/DeepSeek-R1-Distill-Llama-70B 请求失败: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Read timed out. (read timeout=60)
2025-04-04 22:55:40.809 | INFO     | __main__:analyze_data:543 - 尝试下一个模型...
2025-04-04 22:55:40.810 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-r1-instruct
2025-04-04 22:55:40.810 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:55:40.810 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:55:40.810 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-r1-instruct', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和样本数据，提供深入的见解和建议。\n        \n        ## 数据库结构\n        \n## 样本数据\n\n### 表: accounts (前1条记录)\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]\n\n### 表: transactions (前5条记录)\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]\n\n### 表: analysis_results (前1条记录)\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n\n        ## 分析要求\n        \n        请提供以下分析:\n        \n        1. 数据库结构分析：评估表结构设计，包括表关系、主键、外键等\n        2. 数据质量分析：评估数据的完整性、一致性和有效性\n        3. 数据模式和趋势：识别数据中的模式、趋势和异常\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:55:40.989 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-r1-instruct 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:55:40.989 | WARNING  | __main__:analyze_data:536 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 22:55:40.990 | INFO     | __main__:analyze_data:543 - 尝试下一个模型...
2025-04-04 22:55:40.990 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-r1-lite
2025-04-04 22:55:40.990 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:55:40.990 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:55:40.990 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-r1-lite', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和样本数据，提供深入的见解和建议。\n        \n        ## 数据库结构\n        \n## 样本数据\n\n### 表: accounts (前1条记录)\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]\n\n### 表: transactions (前5条记录)\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]\n\n### 表: analysis_results (前1条记录)\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n\n        ## 分析要求\n        \n        请提供以下分析:\n        \n        1. 数据库结构分析：评估表结构设计，包括表关系、主键、外键等\n        2. 数据质量分析：评估数据的完整性、一致性和有效性\n        3. 数据模式和趋势：识别数据中的模式、趋势和异常\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:55:41.125 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-r1-lite 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:55:41.125 | WARNING  | __main__:analyze_data:536 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 22:55:41.126 | INFO     | __main__:analyze_data:543 - 尝试下一个模型...
2025-04-04 22:55:41.126 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-r1-plus
2025-04-04 22:55:41.126 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:55:41.126 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:55:41.126 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-r1-plus', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和样本数据，提供深入的见解和建议。\n        \n        ## 数据库结构\n        \n## 样本数据\n\n### 表: accounts (前1条记录)\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]\n\n### 表: transactions (前5条记录)\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]\n\n### 表: analysis_results (前1条记录)\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n\n        ## 分析要求\n        \n        请提供以下分析:\n        \n        1. 数据库结构分析：评估表结构设计，包括表关系、主键、外键等\n        2. 数据质量分析：评估数据的完整性、一致性和有效性\n        3. 数据模式和趋势：识别数据中的模式、趋势和异常\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:55:41.308 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-r1-plus 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:55:41.309 | WARNING  | __main__:analyze_data:536 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 22:55:41.309 | ERROR    | __main__:analyze_data:547 - 所有模型尝试都失败，生成模拟分析结果
2025-04-04 22:55:41.310 | ERROR    | __main__:main:731 - 大模型分析失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:55:41.310 | INFO     | __main__:main:736 - 开始分析账户 1...
2025-04-04 22:55:41.601 | INFO     | __main__:analyze_data:463 - 调用大模型API，模型: deepseek-chat，API基础URL: https://api.siliconflow.cn/v1
2025-04-04 22:55:41.601 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-ai/DeepSeek-R1
2025-04-04 22:55:41.601 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:55:41.601 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:55:41.601 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-ai/DeepSeek-R1', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:56:26.249 | INFO     | __main__:main:688 - 开始分析数据库...
2025-04-04 22:56:26.249 | INFO     | __main__:main:692 - 数据库路径: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 22:56:26.250 | INFO     | __main__:__init__:114 - 已连接到数据库: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 22:56:26.250 | INFO     | __main__:main:697 - 已初始化数据分析器，连接到数据库: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 22:56:26.251 | INFO     | __main__:main:701 - 已准备数据用于大模型分析
2025-04-04 22:56:26.252 | INFO     | __main__:__init__:451 - 初始化大模型分析器，使用模型: deepseek-chat
2025-04-04 22:56:26.252 | INFO     | __main__:main:705 - 已初始化大模型分析器
2025-04-04 22:56:26.252 | INFO     | __main__:main:708 - 开始使用大模型分析数据...
2025-04-04 22:56:26.252 | INFO     | __main__:analyze_data:463 - 调用大模型API，模型: deepseek-chat，API基础URL: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:56:26.252 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-ai/DeepSeek-R1
2025-04-04 22:56:26.252 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions/chat/completions
2025-04-04 22:56:26.252 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:56:26.253 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-ai/DeepSeek-R1', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和样本数据，提供深入的见解和建议。\n        \n        ## 数据库结构\n        \n## 样本数据\n\n### 表: accounts (前1条记录)\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]\n\n### 表: transactions (前5条记录)\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]\n\n### 表: analysis_results (前1条记录)\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n\n        ## 分析要求\n        \n        请提供以下分析:\n        \n        1. 数据库结构分析：评估表结构设计，包括表关系、主键、外键等\n        2. 数据质量分析：评估数据的完整性、一致性和有效性\n        3. 数据模式和趋势：识别数据中的模式、趋势和异常\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:56:26.432 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-ai/DeepSeek-R1 请求失败: 404 Client Error: 404 Page not found for url: https://api.siliconflow.cn/v1/chat/completions/chat/completions
2025-04-04 22:56:26.432 | WARNING  | __main__:analyze_data:538 - API错误状态码: 404
2025-04-04 22:56:26.432 | WARNING  | __main__:analyze_data:539 - API错误响应: 404 page not found
2025-04-04 22:56:26.432 | INFO     | __main__:analyze_data:543 - 尝试下一个模型...
2025-04-04 22:56:26.432 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-ai/DeepSeek-R1-Distill-Llama-70B
2025-04-04 22:56:26.432 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions/chat/completions
2025-04-04 22:56:26.432 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:56:26.433 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-ai/DeepSeek-R1-Distill-Llama-70B', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和样本数据，提供深入的见解和建议。\n        \n        ## 数据库结构\n        \n## 样本数据\n\n### 表: accounts (前1条记录)\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]\n\n### 表: transactions (前5条记录)\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]\n\n### 表: analysis_results (前1条记录)\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n\n        ## 分析要求\n        \n        请提供以下分析:\n        \n        1. 数据库结构分析：评估表结构设计，包括表关系、主键、外键等\n        2. 数据质量分析：评估数据的完整性、一致性和有效性\n        3. 数据模式和趋势：识别数据中的模式、趋势和异常\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:56:26.593 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-ai/DeepSeek-R1-Distill-Llama-70B 请求失败: 404 Client Error: 404 Page not found for url: https://api.siliconflow.cn/v1/chat/completions/chat/completions
2025-04-04 22:56:26.594 | WARNING  | __main__:analyze_data:538 - API错误状态码: 404
2025-04-04 22:56:26.594 | WARNING  | __main__:analyze_data:539 - API错误响应: 404 page not found
2025-04-04 22:56:26.594 | INFO     | __main__:analyze_data:543 - 尝试下一个模型...
2025-04-04 22:56:26.594 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-r1-instruct
2025-04-04 22:56:26.594 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions/chat/completions
2025-04-04 22:56:26.594 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:56:26.595 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-r1-instruct', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和样本数据，提供深入的见解和建议。\n        \n        ## 数据库结构\n        \n## 样本数据\n\n### 表: accounts (前1条记录)\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]\n\n### 表: transactions (前5条记录)\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]\n\n### 表: analysis_results (前1条记录)\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n\n        ## 分析要求\n        \n        请提供以下分析:\n        \n        1. 数据库结构分析：评估表结构设计，包括表关系、主键、外键等\n        2. 数据质量分析：评估数据的完整性、一致性和有效性\n        3. 数据模式和趋势：识别数据中的模式、趋势和异常\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:56:26.759 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-r1-instruct 请求失败: 404 Client Error: 404 Page not found for url: https://api.siliconflow.cn/v1/chat/completions/chat/completions
2025-04-04 22:56:26.759 | WARNING  | __main__:analyze_data:538 - API错误状态码: 404
2025-04-04 22:56:26.759 | WARNING  | __main__:analyze_data:539 - API错误响应: 404 page not found
2025-04-04 22:56:26.759 | INFO     | __main__:analyze_data:543 - 尝试下一个模型...
2025-04-04 22:56:26.759 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-r1-lite
2025-04-04 22:56:26.760 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions/chat/completions
2025-04-04 22:56:26.760 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:56:26.760 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-r1-lite', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和样本数据，提供深入的见解和建议。\n        \n        ## 数据库结构\n        \n## 样本数据\n\n### 表: accounts (前1条记录)\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]\n\n### 表: transactions (前5条记录)\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]\n\n### 表: analysis_results (前1条记录)\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n\n        ## 分析要求\n        \n        请提供以下分析:\n        \n        1. 数据库结构分析：评估表结构设计，包括表关系、主键、外键等\n        2. 数据质量分析：评估数据的完整性、一致性和有效性\n        3. 数据模式和趋势：识别数据中的模式、趋势和异常\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:56:26.969 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-r1-lite 请求失败: 404 Client Error: 404 Page not found for url: https://api.siliconflow.cn/v1/chat/completions/chat/completions
2025-04-04 22:56:26.969 | WARNING  | __main__:analyze_data:538 - API错误状态码: 404
2025-04-04 22:56:26.970 | WARNING  | __main__:analyze_data:539 - API错误响应: 404 page not found
2025-04-04 22:56:26.970 | INFO     | __main__:analyze_data:543 - 尝试下一个模型...
2025-04-04 22:56:26.970 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-r1-plus
2025-04-04 22:56:26.970 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions/chat/completions
2025-04-04 22:56:26.970 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:56:26.970 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-r1-plus', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和样本数据，提供深入的见解和建议。\n        \n        ## 数据库结构\n        \n## 样本数据\n\n### 表: accounts (前1条记录)\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]\n\n### 表: transactions (前5条记录)\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]\n\n### 表: analysis_results (前1条记录)\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n\n        ## 分析要求\n        \n        请提供以下分析:\n        \n        1. 数据库结构分析：评估表结构设计，包括表关系、主键、外键等\n        2. 数据质量分析：评估数据的完整性、一致性和有效性\n        3. 数据模式和趋势：识别数据中的模式、趋势和异常\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:56:27.149 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-r1-plus 请求失败: 404 Client Error: 404 Page not found for url: https://api.siliconflow.cn/v1/chat/completions/chat/completions
2025-04-04 22:56:27.150 | WARNING  | __main__:analyze_data:538 - API错误状态码: 404
2025-04-04 22:56:27.150 | WARNING  | __main__:analyze_data:539 - API错误响应: 404 page not found
2025-04-04 22:56:27.150 | ERROR    | __main__:analyze_data:547 - 所有模型尝试都失败，生成模拟分析结果
2025-04-04 22:56:27.150 | ERROR    | __main__:main:731 - 大模型分析失败: 404 Client Error: 404 Page not found for url: https://api.siliconflow.cn/v1/chat/completions/chat/completions
2025-04-04 22:56:27.150 | INFO     | __main__:main:736 - 开始分析账户 1...
2025-04-04 22:56:27.448 | INFO     | __main__:analyze_data:463 - 调用大模型API，模型: deepseek-chat，API基础URL: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:56:27.448 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-ai/DeepSeek-R1
2025-04-04 22:56:27.448 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions/chat/completions
2025-04-04 22:56:27.448 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:56:27.448 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-ai/DeepSeek-R1', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:56:27.576 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-ai/DeepSeek-R1 请求失败: 404 Client Error: 404 Page not found for url: https://api.siliconflow.cn/v1/chat/completions/chat/completions
2025-04-04 22:56:27.576 | WARNING  | __main__:analyze_data:538 - API错误状态码: 404
2025-04-04 22:56:27.576 | WARNING  | __main__:analyze_data:539 - API错误响应: 404 page not found
2025-04-04 22:56:27.576 | INFO     | __main__:analyze_data:543 - 尝试下一个模型...
2025-04-04 22:56:27.577 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-ai/DeepSeek-R1-Distill-Llama-70B
2025-04-04 22:56:27.577 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions/chat/completions
2025-04-04 22:56:27.577 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:56:27.577 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-ai/DeepSeek-R1-Distill-Llama-70B', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:56:27.717 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-ai/DeepSeek-R1-Distill-Llama-70B 请求失败: 404 Client Error: 404 Page not found for url: https://api.siliconflow.cn/v1/chat/completions/chat/completions
2025-04-04 22:56:27.717 | WARNING  | __main__:analyze_data:538 - API错误状态码: 404
2025-04-04 22:56:27.718 | WARNING  | __main__:analyze_data:539 - API错误响应: 404 page not found
2025-04-04 22:56:27.718 | INFO     | __main__:analyze_data:543 - 尝试下一个模型...
2025-04-04 22:56:27.718 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-r1-instruct
2025-04-04 22:56:27.718 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions/chat/completions
2025-04-04 22:56:27.718 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:56:27.718 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-r1-instruct', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:56:27.870 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-r1-instruct 请求失败: 404 Client Error: 404 Page not found for url: https://api.siliconflow.cn/v1/chat/completions/chat/completions
2025-04-04 22:56:27.870 | WARNING  | __main__:analyze_data:538 - API错误状态码: 404
2025-04-04 22:56:27.871 | WARNING  | __main__:analyze_data:539 - API错误响应: 404 page not found
2025-04-04 22:56:27.871 | INFO     | __main__:analyze_data:543 - 尝试下一个模型...
2025-04-04 22:56:27.871 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-r1-lite
2025-04-04 22:56:27.871 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions/chat/completions
2025-04-04 22:56:27.871 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:56:27.871 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-r1-lite', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:56:28.069 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-r1-lite 请求失败: 404 Client Error: 404 Page not found for url: https://api.siliconflow.cn/v1/chat/completions/chat/completions
2025-04-04 22:56:28.070 | WARNING  | __main__:analyze_data:538 - API错误状态码: 404
2025-04-04 22:56:28.070 | WARNING  | __main__:analyze_data:539 - API错误响应: 404 page not found
2025-04-04 22:56:28.070 | INFO     | __main__:analyze_data:543 - 尝试下一个模型...
2025-04-04 22:56:28.070 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-r1-plus
2025-04-04 22:56:28.070 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions/chat/completions
2025-04-04 22:56:28.070 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:56:28.070 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-r1-plus', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:56:28.230 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-r1-plus 请求失败: 404 Client Error: 404 Page not found for url: https://api.siliconflow.cn/v1/chat/completions/chat/completions
2025-04-04 22:56:28.230 | WARNING  | __main__:analyze_data:538 - API错误状态码: 404
2025-04-04 22:56:28.230 | WARNING  | __main__:analyze_data:539 - API错误响应: 404 page not found
2025-04-04 22:56:28.230 | ERROR    | __main__:analyze_data:547 - 所有模型尝试都失败，生成模拟分析结果
2025-04-04 22:56:28.231 | ERROR    | __main__:main:790 - 账户 1 分析失败: 404 Client Error: 404 Page not found for url: https://api.siliconflow.cn/v1/chat/completions/chat/completions
2025-04-04 22:56:28.231 | INFO     | __main__:close:120 - 数据库连接已关闭
2025-04-04 22:56:28.231 | INFO     | __main__:main:803 - 分析完成
2025-04-04 22:56:47.936 | INFO     | __main__:main:688 - 开始分析数据库...
2025-04-04 22:56:47.936 | INFO     | __main__:main:692 - 数据库路径: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 22:56:47.937 | INFO     | __main__:__init__:114 - 已连接到数据库: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 22:56:47.937 | INFO     | __main__:main:697 - 已初始化数据分析器，连接到数据库: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 22:56:47.938 | INFO     | __main__:main:701 - 已准备数据用于大模型分析
2025-04-04 22:56:47.938 | INFO     | __main__:__init__:451 - 初始化大模型分析器，使用模型: deepseek-chat
2025-04-04 22:56:47.938 | INFO     | __main__:main:705 - 已初始化大模型分析器
2025-04-04 22:56:47.938 | INFO     | __main__:main:708 - 开始使用大模型分析数据...
2025-04-04 22:56:47.938 | INFO     | __main__:analyze_data:463 - 调用大模型API，模型: deepseek-chat，API基础URL: https://api.siliconflow.cn/v1
2025-04-04 22:56:47.938 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-ai/DeepSeek-R1
2025-04-04 22:56:47.939 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:56:47.939 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:56:47.939 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-ai/DeepSeek-R1', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和样本数据，提供深入的见解和建议。\n        \n        ## 数据库结构\n        \n## 样本数据\n\n### 表: accounts (前1条记录)\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]\n\n### 表: transactions (前5条记录)\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]\n\n### 表: analysis_results (前1条记录)\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n\n        ## 分析要求\n        \n        请提供以下分析:\n        \n        1. 数据库结构分析：评估表结构设计，包括表关系、主键、外键等\n        2. 数据质量分析：评估数据的完整性、一致性和有效性\n        3. 数据模式和趋势：识别数据中的模式、趋势和异常\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:57:38.033 | INFO     | __main__:close:120 - 数据库连接已关闭
2025-04-04 22:57:45.771 | INFO     | __main__:main:688 - 开始分析数据库...
2025-04-04 22:57:45.771 | INFO     | __main__:main:692 - 数据库路径: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 22:57:45.771 | INFO     | __main__:__init__:114 - 已连接到数据库: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 22:57:45.771 | INFO     | __main__:main:697 - 已初始化数据分析器，连接到数据库: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 22:57:45.772 | INFO     | __main__:main:701 - 已准备数据用于大模型分析
2025-04-04 22:57:45.773 | INFO     | __main__:__init__:451 - 初始化大模型分析器，使用模型: deepseek-ai/DeepSeek-R1
2025-04-04 22:57:45.773 | INFO     | __main__:main:705 - 已初始化大模型分析器
2025-04-04 22:57:45.773 | INFO     | __main__:main:708 - 开始使用大模型分析数据...
2025-04-04 22:57:45.773 | INFO     | __main__:analyze_data:463 - 调用大模型API，模型: deepseek-ai/DeepSeek-R1，API基础URL: https://api.siliconflow.cn/v1
2025-04-04 22:57:45.773 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-ai/DeepSeek-R1
2025-04-04 22:57:45.773 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:57:45.773 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:57:45.774 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-ai/DeepSeek-R1', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和样本数据，提供深入的见解和建议。\n        \n        ## 数据库结构\n        \n## 样本数据\n\n### 表: accounts (前1条记录)\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]\n\n### 表: transactions (前5条记录)\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]\n\n### 表: analysis_results (前1条记录)\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n\n        ## 分析要求\n        \n        请提供以下分析:\n        \n        1. 数据库结构分析：评估表结构设计，包括表关系、主键、外键等\n        2. 数据质量分析：评估数据的完整性、一致性和有效性\n        3. 数据模式和趋势：识别数据中的模式、趋势和异常\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:58:45.921 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-ai/DeepSeek-R1 请求失败: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Read timed out. (read timeout=60)
2025-04-04 22:58:45.922 | INFO     | __main__:analyze_data:543 - 尝试下一个模型...
2025-04-04 22:58:45.922 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-ai/DeepSeek-R1-Distill-Llama-70B
2025-04-04 22:58:45.922 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:58:45.923 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:58:45.923 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-ai/DeepSeek-R1-Distill-Llama-70B', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和样本数据，提供深入的见解和建议。\n        \n        ## 数据库结构\n        \n## 样本数据\n\n### 表: accounts (前1条记录)\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]\n\n### 表: transactions (前5条记录)\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]\n\n### 表: analysis_results (前1条记录)\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n\n        ## 分析要求\n        \n        请提供以下分析:\n        \n        1. 数据库结构分析：评估表结构设计，包括表关系、主键、外键等\n        2. 数据质量分析：评估数据的完整性、一致性和有效性\n        3. 数据模式和趋势：识别数据中的模式、趋势和异常\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:59:46.031 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-ai/DeepSeek-R1-Distill-Llama-70B 请求失败: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Read timed out. (read timeout=60)
2025-04-04 22:59:46.031 | INFO     | __main__:analyze_data:543 - 尝试下一个模型...
2025-04-04 22:59:46.031 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-r1-instruct
2025-04-04 22:59:46.032 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:59:46.032 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:59:46.032 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-r1-instruct', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和样本数据，提供深入的见解和建议。\n        \n        ## 数据库结构\n        \n## 样本数据\n\n### 表: accounts (前1条记录)\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]\n\n### 表: transactions (前5条记录)\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]\n\n### 表: analysis_results (前1条记录)\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n\n        ## 分析要求\n        \n        请提供以下分析:\n        \n        1. 数据库结构分析：评估表结构设计，包括表关系、主键、外键等\n        2. 数据质量分析：评估数据的完整性、一致性和有效性\n        3. 数据模式和趋势：识别数据中的模式、趋势和异常\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:59:46.161 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-r1-instruct 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:59:46.161 | WARNING  | __main__:analyze_data:536 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 22:59:46.161 | INFO     | __main__:analyze_data:543 - 尝试下一个模型...
2025-04-04 22:59:46.162 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-r1-lite
2025-04-04 22:59:46.162 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:59:46.163 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:59:46.163 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-r1-lite', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和样本数据，提供深入的见解和建议。\n        \n        ## 数据库结构\n        \n## 样本数据\n\n### 表: accounts (前1条记录)\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]\n\n### 表: transactions (前5条记录)\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]\n\n### 表: analysis_results (前1条记录)\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n\n        ## 分析要求\n        \n        请提供以下分析:\n        \n        1. 数据库结构分析：评估表结构设计，包括表关系、主键、外键等\n        2. 数据质量分析：评估数据的完整性、一致性和有效性\n        3. 数据模式和趋势：识别数据中的模式、趋势和异常\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:59:46.339 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-r1-lite 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:59:46.339 | WARNING  | __main__:analyze_data:536 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 22:59:46.339 | INFO     | __main__:analyze_data:543 - 尝试下一个模型...
2025-04-04 22:59:46.339 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-r1-plus
2025-04-04 22:59:46.339 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:59:46.340 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:59:46.340 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-r1-plus', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和样本数据，提供深入的见解和建议。\n        \n        ## 数据库结构\n        \n## 样本数据\n\n### 表: accounts (前1条记录)\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]\n\n### 表: transactions (前5条记录)\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]\n\n### 表: analysis_results (前1条记录)\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n\n        ## 分析要求\n        \n        请提供以下分析:\n        \n        1. 数据库结构分析：评估表结构设计，包括表关系、主键、外键等\n        2. 数据质量分析：评估数据的完整性、一致性和有效性\n        3. 数据模式和趋势：识别数据中的模式、趋势和异常\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 22:59:46.512 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-r1-plus 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:59:46.512 | WARNING  | __main__:analyze_data:536 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 22:59:46.512 | ERROR    | __main__:analyze_data:547 - 所有模型尝试都失败，生成模拟分析结果
2025-04-04 22:59:46.512 | ERROR    | __main__:main:731 - 大模型分析失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:59:46.512 | INFO     | __main__:main:736 - 开始分析账户 1...
2025-04-04 22:59:46.826 | INFO     | __main__:analyze_data:463 - 调用大模型API，模型: deepseek-ai/DeepSeek-R1，API基础URL: https://api.siliconflow.cn/v1
2025-04-04 22:59:46.827 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-ai/DeepSeek-R1
2025-04-04 22:59:46.827 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 22:59:46.827 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 22:59:46.827 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-ai/DeepSeek-R1', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:00:46.944 | WARNING  | __main__:analyze_data:530 - 使用模型 deepseek-ai/DeepSeek-R1 请求失败: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Read timed out. (read timeout=60)
2025-04-04 23:00:46.945 | INFO     | __main__:analyze_data:543 - 尝试下一个模型...
2025-04-04 23:00:46.945 | INFO     | __main__:analyze_data:481 - 尝试使用模型: deepseek-ai/DeepSeek-R1-Distill-Llama-70B
2025-04-04 23:00:46.945 | DEBUG    | __main__:analyze_data:501 - API请求: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:00:46.945 | DEBUG    | __main__:analyze_data:502 - 请求头: {'Content-Type': 'application/json', 'Authorization': 'Bearer sk-***'}
2025-04-04 23:00:46.945 | DEBUG    | __main__:analyze_data:503 - 请求体: {'model': 'deepseek-ai/DeepSeek-R1-Distill-Llama-70B', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:01:11.252 | INFO     | __main__:close:120 - 数据库连接已关闭
2025-04-04 23:05:33.455 | INFO     | __main__:main:624 - 开始分析数据库...
2025-04-04 23:05:33.455 | INFO     | __main__:main:628 - 数据库路径: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 23:05:33.455 | INFO     | __main__:__init__:158 - 已连接到数据库: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 23:05:33.457 | INFO     | __main__:__init__:55 - 初始化DeepSeek-R1模型，API基础URL: https://api.siliconflow.cn/v1
2025-04-04 23:05:33.457 | INFO     | __main__:__init__:461 - 初始化大模型分析器完成
2025-04-04 23:05:33.457 | INFO     | __main__:main:641 - 开始分析整个数据库...
2025-04-04 23:05:33.457 | INFO     | __main__:analyze_data:473 - 调用大模型API...
2025-04-04 23:05:33.457 | INFO     | __main__:generate:71 - 发送请求到DeepSeek API...
2025-04-04 23:05:33.586 | ERROR    | __main__:analyze_data:489 - 分析过程中出错: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:05:33.593 | ERROR    | __main__:analyze_data:490 - Traceback (most recent call last):
  File "/Users/aladam/Desktop/langgraph-demo/src/main.py", line 481, in analyze_data
    analysis = self.model.generate(messages)
  File "/Users/aladam/Desktop/langgraph-demo/src/main.py", line 79, in generate
    response.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions

2025-04-04 23:05:33.594 | ERROR    | __main__:main:653 - 数据库分析失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:05:33.594 | INFO     | __main__:main:660 - 模拟分析报告已保存到: /Users/aladam/Desktop/langgraph-demo/database_analysis_report_mock.md
2025-04-04 23:05:33.595 | INFO     | __main__:main:664 - 开始分析账户 1...
2025-04-04 23:05:34.026 | INFO     | __main__:analyze_data:473 - 调用大模型API...
2025-04-04 23:05:34.026 | INFO     | __main__:generate:71 - 发送请求到DeepSeek API...
2025-04-04 23:05:34.157 | ERROR    | __main__:analyze_data:489 - 分析过程中出错: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:05:34.158 | ERROR    | __main__:analyze_data:490 - Traceback (most recent call last):
  File "/Users/aladam/Desktop/langgraph-demo/src/main.py", line 481, in analyze_data
    analysis = self.model.generate(messages)
  File "/Users/aladam/Desktop/langgraph-demo/src/main.py", line 79, in generate
    response.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions

2025-04-04 23:05:34.158 | ERROR    | __main__:main:719 - 账户 1 分析失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:05:34.159 | INFO     | __main__:main:726 - 账户模拟分析报告已保存到: /Users/aladam/Desktop/langgraph-demo/account_1_analysis_report_mock.md
2025-04-04 23:05:34.159 | INFO     | __main__:close:164 - 数据库连接已关闭
2025-04-04 23:05:34.159 | INFO     | __main__:main:740 - 分析完成
2025-04-04 23:06:55.968 | INFO     | __main__:main:659 - 开始分析数据库...
2025-04-04 23:06:55.969 | INFO     | __main__:main:663 - 数据库路径: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 23:06:55.969 | INFO     | __main__:__init__:198 - 已连接到数据库: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 23:06:55.970 | INFO     | __main__:__init__:55 - 初始化DeepSeek-R1模型，API基础URL: https://api.siliconflow.cn/v1
2025-04-04 23:06:55.970 | INFO     | __main__:__init__:496 - 初始化大模型分析器完成
2025-04-04 23:06:55.970 | INFO     | __main__:main:676 - 开始分析整个数据库...
2025-04-04 23:06:55.971 | INFO     | __main__:analyze_data:514 - 调用大模型API...
2025-04-04 23:06:55.971 | DEBUG    | __main__:generate:89 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:06:55.971 | DEBUG    | __main__:generate:90 - API请求体: {'model': 'deepseek-chat', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和内容，提供深入的见解。\n        \n        数据库名称: account_data.db\n        \n        数据库包含以下表:\n        accounts, transactions, analysis_results\n        \n        表结构:\n        \n表 \'accounts\' 结构:\n- id (TEXT)\n- name (TEXT)\n- created_at (TIMESTAMP)\n- updated_at (TIMESTAMP)\n- status (TEXT)\n- metadata (TEXT)\n\n表 \'transactions\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- amount (REAL)\n- type (TEXT)\n- timestamp (TIMESTAMP)\n- description (TEXT)\n- metadata (TEXT)\n\n表 \'analysis_results\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- timestamp (TIMESTAMP)\n- result_type (TEXT)\n- result_data (TEXT)\n- metadata (TEXT)\n\n样本数据:\n\n表 \'accounts\' 样本数据 (前5条):\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]...\n\n表 \'transactions\' 样本数据 (前5条):\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]...\n\n表 \'analysis_results\' 样本数据 (前5条):\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]...\n\n        请提供以下分析:\n        1. 数据库结构分析：评估表之间的关系和设计模式\n        2. 数据质量分析：识别潜在的数据质量问题\n        3. 数据模式和趋势：识别数据中的模式和趋势\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:06:55.971 | INFO     | __main__:generate:92 - 发送请求到DeepSeek API...
2025-04-04 23:06:56.148 | DEBUG    | __main__:generate:102 - API响应状态码: 400
2025-04-04 23:06:56.148 | DEBUG    | __main__:generate:103 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:06:56.148 | ERROR    | __main__:generate:112 - API请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:06:56.148 | ERROR    | __main__:generate:118 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:06:56.149 | INFO     | __main__:main:680 - 数据库分析成功
2025-04-04 23:06:56.149 | INFO     | __main__:main:686 - 分析报告已保存到: /Users/aladam/Desktop/langgraph-demo/database_analysis_report.md
2025-04-04 23:06:56.149 | INFO     | __main__:main:699 - 开始分析账户 1...
2025-04-04 23:06:56.586 | INFO     | __main__:analyze_data:514 - 调用大模型API...
2025-04-04 23:06:56.586 | DEBUG    | __main__:generate:89 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:06:56.586 | DEBUG    | __main__:generate:90 - API请求体: {'model': 'deepseek-chat', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:06:56.586 | INFO     | __main__:generate:92 - 发送请求到DeepSeek API...
2025-04-04 23:06:56.720 | DEBUG    | __main__:generate:102 - API响应状态码: 400
2025-04-04 23:06:56.721 | DEBUG    | __main__:generate:103 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:06:56.721 | ERROR    | __main__:generate:112 - API请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:06:56.721 | ERROR    | __main__:generate:118 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:06:56.721 | INFO     | __main__:main:738 - 账户 1 分析成功
2025-04-04 23:06:56.722 | INFO     | __main__:main:744 - 账户分析报告已保存到: /Users/aladam/Desktop/langgraph-demo/account_1_analysis_report.md
2025-04-04 23:06:56.722 | INFO     | __main__:main:752 - 账户交易图表已保存到: /Users/aladam/Desktop/langgraph-demo/account_1_chart.png
2025-04-04 23:06:56.723 | INFO     | __main__:close:204 - 数据库连接已关闭
2025-04-04 23:06:56.723 | INFO     | __main__:main:775 - 分析完成
2025-04-04 23:07:42.682 | INFO     | __main__:main:674 - 开始分析数据库...
2025-04-04 23:07:42.682 | INFO     | __main__:main:678 - 数据库路径: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 23:07:42.683 | INFO     | __main__:__init__:213 - 已连接到数据库: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 23:07:42.684 | INFO     | __main__:__init__:55 - 初始化DeepSeek-R1模型，API基础URL: https://api.siliconflow.cn/v1
2025-04-04 23:07:42.684 | INFO     | __main__:__init__:511 - 初始化大模型分析器完成
2025-04-04 23:07:42.684 | INFO     | __main__:main:691 - 开始分析整个数据库...
2025-04-04 23:07:42.684 | INFO     | __main__:analyze_data:529 - 调用大模型API...
2025-04-04 23:07:42.684 | INFO     | __main__:generate:84 - 尝试使用模型: deepseek-chat
2025-04-04 23:07:42.685 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:07:42.685 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-chat', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和内容，提供深入的见解。\n        \n        数据库名称: account_data.db\n        \n        数据库包含以下表:\n        accounts, transactions, analysis_results\n        \n        表结构:\n        \n表 \'accounts\' 结构:\n- id (TEXT)\n- name (TEXT)\n- created_at (TIMESTAMP)\n- updated_at (TIMESTAMP)\n- status (TEXT)\n- metadata (TEXT)\n\n表 \'transactions\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- amount (REAL)\n- type (TEXT)\n- timestamp (TIMESTAMP)\n- description (TEXT)\n- metadata (TEXT)\n\n表 \'analysis_results\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- timestamp (TIMESTAMP)\n- result_type (TEXT)\n- result_data (TEXT)\n- metadata (TEXT)\n\n样本数据:\n\n表 \'accounts\' 样本数据 (前5条):\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]...\n\n表 \'transactions\' 样本数据 (前5条):\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]...\n\n表 \'analysis_results\' 样本数据 (前5条):\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]...\n\n        请提供以下分析:\n        1. 数据库结构分析：评估表之间的关系和设计模式\n        2. 数据质量分析：识别潜在的数据质量问题\n        3. 数据模式和趋势：识别数据中的模式和趋势\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:07:42.685 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API，使用模型: deepseek-chat...
2025-04-04 23:07:42.874 | DEBUG    | __main__:generate:109 - API响应状态码: 400
2025-04-04 23:07:42.875 | DEBUG    | __main__:generate:110 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:07:42.875 | WARNING  | __main__:generate:120 - 使用模型 deepseek-chat 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:07:42.875 | WARNING  | __main__:generate:126 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:07:42.875 | INFO     | __main__:generate:84 - 尝试使用模型: deepseek-v2
2025-04-04 23:07:42.875 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:07:42.875 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-v2', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和内容，提供深入的见解。\n        \n        数据库名称: account_data.db\n        \n        数据库包含以下表:\n        accounts, transactions, analysis_results\n        \n        表结构:\n        \n表 \'accounts\' 结构:\n- id (TEXT)\n- name (TEXT)\n- created_at (TIMESTAMP)\n- updated_at (TIMESTAMP)\n- status (TEXT)\n- metadata (TEXT)\n\n表 \'transactions\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- amount (REAL)\n- type (TEXT)\n- timestamp (TIMESTAMP)\n- description (TEXT)\n- metadata (TEXT)\n\n表 \'analysis_results\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- timestamp (TIMESTAMP)\n- result_type (TEXT)\n- result_data (TEXT)\n- metadata (TEXT)\n\n样本数据:\n\n表 \'accounts\' 样本数据 (前5条):\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]...\n\n表 \'transactions\' 样本数据 (前5条):\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]...\n\n表 \'analysis_results\' 样本数据 (前5条):\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]...\n\n        请提供以下分析:\n        1. 数据库结构分析：评估表之间的关系和设计模式\n        2. 数据质量分析：识别潜在的数据质量问题\n        3. 数据模式和趋势：识别数据中的模式和趋势\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:07:42.875 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API，使用模型: deepseek-v2...
2025-04-04 23:07:43.018 | DEBUG    | __main__:generate:109 - API响应状态码: 400
2025-04-04 23:07:43.018 | DEBUG    | __main__:generate:110 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:07:43.018 | WARNING  | __main__:generate:120 - 使用模型 deepseek-v2 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:07:43.018 | WARNING  | __main__:generate:126 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:07:43.018 | INFO     | __main__:generate:84 - 尝试使用模型: deepseek-llm
2025-04-04 23:07:43.018 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:07:43.018 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-llm', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和内容，提供深入的见解。\n        \n        数据库名称: account_data.db\n        \n        数据库包含以下表:\n        accounts, transactions, analysis_results\n        \n        表结构:\n        \n表 \'accounts\' 结构:\n- id (TEXT)\n- name (TEXT)\n- created_at (TIMESTAMP)\n- updated_at (TIMESTAMP)\n- status (TEXT)\n- metadata (TEXT)\n\n表 \'transactions\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- amount (REAL)\n- type (TEXT)\n- timestamp (TIMESTAMP)\n- description (TEXT)\n- metadata (TEXT)\n\n表 \'analysis_results\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- timestamp (TIMESTAMP)\n- result_type (TEXT)\n- result_data (TEXT)\n- metadata (TEXT)\n\n样本数据:\n\n表 \'accounts\' 样本数据 (前5条):\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]...\n\n表 \'transactions\' 样本数据 (前5条):\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]...\n\n表 \'analysis_results\' 样本数据 (前5条):\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]...\n\n        请提供以下分析:\n        1. 数据库结构分析：评估表之间的关系和设计模式\n        2. 数据质量分析：识别潜在的数据质量问题\n        3. 数据模式和趋势：识别数据中的模式和趋势\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:07:43.019 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API，使用模型: deepseek-llm...
2025-04-04 23:07:43.197 | DEBUG    | __main__:generate:109 - API响应状态码: 400
2025-04-04 23:07:43.197 | DEBUG    | __main__:generate:110 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:07:43.197 | WARNING  | __main__:generate:120 - 使用模型 deepseek-llm 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:07:43.197 | WARNING  | __main__:generate:126 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:07:43.197 | INFO     | __main__:generate:84 - 尝试使用模型: deepseek-coder
2025-04-04 23:07:43.197 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:07:43.197 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-coder', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和内容，提供深入的见解。\n        \n        数据库名称: account_data.db\n        \n        数据库包含以下表:\n        accounts, transactions, analysis_results\n        \n        表结构:\n        \n表 \'accounts\' 结构:\n- id (TEXT)\n- name (TEXT)\n- created_at (TIMESTAMP)\n- updated_at (TIMESTAMP)\n- status (TEXT)\n- metadata (TEXT)\n\n表 \'transactions\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- amount (REAL)\n- type (TEXT)\n- timestamp (TIMESTAMP)\n- description (TEXT)\n- metadata (TEXT)\n\n表 \'analysis_results\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- timestamp (TIMESTAMP)\n- result_type (TEXT)\n- result_data (TEXT)\n- metadata (TEXT)\n\n样本数据:\n\n表 \'accounts\' 样本数据 (前5条):\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]...\n\n表 \'transactions\' 样本数据 (前5条):\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]...\n\n表 \'analysis_results\' 样本数据 (前5条):\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]...\n\n        请提供以下分析:\n        1. 数据库结构分析：评估表之间的关系和设计模式\n        2. 数据质量分析：识别潜在的数据质量问题\n        3. 数据模式和趋势：识别数据中的模式和趋势\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:07:43.197 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API，使用模型: deepseek-coder...
2025-04-04 23:07:43.321 | DEBUG    | __main__:generate:109 - API响应状态码: 400
2025-04-04 23:07:43.321 | DEBUG    | __main__:generate:110 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:07:43.321 | WARNING  | __main__:generate:120 - 使用模型 deepseek-coder 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:07:43.321 | WARNING  | __main__:generate:126 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:07:43.321 | INFO     | __main__:generate:84 - 尝试使用模型: deepseek-r1
2025-04-04 23:07:43.322 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:07:43.322 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-r1', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和内容，提供深入的见解。\n        \n        数据库名称: account_data.db\n        \n        数据库包含以下表:\n        accounts, transactions, analysis_results\n        \n        表结构:\n        \n表 \'accounts\' 结构:\n- id (TEXT)\n- name (TEXT)\n- created_at (TIMESTAMP)\n- updated_at (TIMESTAMP)\n- status (TEXT)\n- metadata (TEXT)\n\n表 \'transactions\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- amount (REAL)\n- type (TEXT)\n- timestamp (TIMESTAMP)\n- description (TEXT)\n- metadata (TEXT)\n\n表 \'analysis_results\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- timestamp (TIMESTAMP)\n- result_type (TEXT)\n- result_data (TEXT)\n- metadata (TEXT)\n\n样本数据:\n\n表 \'accounts\' 样本数据 (前5条):\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]...\n\n表 \'transactions\' 样本数据 (前5条):\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]...\n\n表 \'analysis_results\' 样本数据 (前5条):\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]...\n\n        请提供以下分析:\n        1. 数据库结构分析：评估表之间的关系和设计模式\n        2. 数据质量分析：识别潜在的数据质量问题\n        3. 数据模式和趋势：识别数据中的模式和趋势\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:07:43.322 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API，使用模型: deepseek-r1...
2025-04-04 23:07:43.484 | DEBUG    | __main__:generate:109 - API响应状态码: 400
2025-04-04 23:07:43.484 | DEBUG    | __main__:generate:110 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:07:43.484 | WARNING  | __main__:generate:120 - 使用模型 deepseek-r1 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:07:43.486 | WARNING  | __main__:generate:126 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:07:43.487 | INFO     | __main__:main:695 - 数据库分析成功
2025-04-04 23:07:43.488 | INFO     | __main__:main:701 - 分析报告已保存到: /Users/aladam/Desktop/langgraph-demo/database_analysis_report.md
2025-04-04 23:07:43.488 | INFO     | __main__:main:714 - 开始分析账户 1...
2025-04-04 23:07:43.948 | INFO     | __main__:analyze_data:529 - 调用大模型API...
2025-04-04 23:07:43.948 | INFO     | __main__:generate:84 - 尝试使用模型: deepseek-chat
2025-04-04 23:07:43.948 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:07:43.948 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-chat', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:07:43.948 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API，使用模型: deepseek-chat...
2025-04-04 23:07:44.074 | DEBUG    | __main__:generate:109 - API响应状态码: 400
2025-04-04 23:07:44.074 | DEBUG    | __main__:generate:110 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:07:44.074 | WARNING  | __main__:generate:120 - 使用模型 deepseek-chat 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:07:44.074 | WARNING  | __main__:generate:126 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:07:44.074 | INFO     | __main__:generate:84 - 尝试使用模型: deepseek-v2
2025-04-04 23:07:44.075 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:07:44.075 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-v2', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:07:44.075 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API，使用模型: deepseek-v2...
2025-04-04 23:07:44.247 | DEBUG    | __main__:generate:109 - API响应状态码: 400
2025-04-04 23:07:44.248 | DEBUG    | __main__:generate:110 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:07:44.248 | WARNING  | __main__:generate:120 - 使用模型 deepseek-v2 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:07:44.248 | WARNING  | __main__:generate:126 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:07:44.248 | INFO     | __main__:generate:84 - 尝试使用模型: deepseek-llm
2025-04-04 23:07:44.248 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:07:44.248 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-llm', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:07:44.248 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API，使用模型: deepseek-llm...
2025-04-04 23:07:44.406 | DEBUG    | __main__:generate:109 - API响应状态码: 400
2025-04-04 23:07:44.407 | DEBUG    | __main__:generate:110 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:07:44.407 | WARNING  | __main__:generate:120 - 使用模型 deepseek-llm 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:07:44.407 | WARNING  | __main__:generate:126 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:07:44.407 | INFO     | __main__:generate:84 - 尝试使用模型: deepseek-coder
2025-04-04 23:07:44.407 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:07:44.407 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-coder', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:07:44.407 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API，使用模型: deepseek-coder...
2025-04-04 23:07:44.539 | DEBUG    | __main__:generate:109 - API响应状态码: 400
2025-04-04 23:07:44.540 | DEBUG    | __main__:generate:110 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:07:44.540 | WARNING  | __main__:generate:120 - 使用模型 deepseek-coder 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:07:44.540 | WARNING  | __main__:generate:126 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:07:44.540 | INFO     | __main__:generate:84 - 尝试使用模型: deepseek-r1
2025-04-04 23:07:44.540 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:07:44.540 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-r1', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:07:44.540 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API，使用模型: deepseek-r1...
2025-04-04 23:07:44.716 | DEBUG    | __main__:generate:109 - API响应状态码: 400
2025-04-04 23:07:44.716 | DEBUG    | __main__:generate:110 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:07:44.717 | WARNING  | __main__:generate:120 - 使用模型 deepseek-r1 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:07:44.717 | WARNING  | __main__:generate:126 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:07:44.717 | INFO     | __main__:main:753 - 账户 1 分析成功
2025-04-04 23:07:44.718 | INFO     | __main__:main:759 - 账户分析报告已保存到: /Users/aladam/Desktop/langgraph-demo/account_1_analysis_report.md
2025-04-04 23:07:44.718 | INFO     | __main__:main:767 - 账户交易图表已保存到: /Users/aladam/Desktop/langgraph-demo/account_1_chart.png
2025-04-04 23:07:44.718 | INFO     | __main__:close:219 - 数据库连接已关闭
2025-04-04 23:07:44.718 | INFO     | __main__:main:790 - 分析完成
2025-04-04 23:10:04.387 | INFO     | __main__:main:945 - 开始分析数据库...
2025-04-04 23:10:04.387 | INFO     | __main__:main:949 - 数据库路径: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 23:10:04.388 | INFO     | __main__:__init__:213 - 已连接到数据库: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 23:10:04.389 | INFO     | __main__:__init__:55 - 初始化DeepSeek-R1模型，API基础URL: https://api.siliconflow.cn/v1
2025-04-04 23:10:04.389 | INFO     | __main__:__init__:511 - 初始化大模型分析器完成
2025-04-04 23:10:04.389 | INFO     | __main__:main:962 - 开始分析整个数据库...
2025-04-04 23:10:04.390 | INFO     | __main__:analyze_data:529 - 调用大模型API...
2025-04-04 23:10:04.390 | INFO     | __main__:generate:84 - 尝试使用模型: deepseek-chat
2025-04-04 23:10:04.390 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:10:04.390 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-chat', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和内容，提供深入的见解。\n        \n        数据库名称: account_data.db\n        \n        数据库包含以下表:\n        accounts, transactions, analysis_results\n        \n        表结构:\n        \n表 \'accounts\' 结构:\n- id (TEXT)\n- name (TEXT)\n- created_at (TIMESTAMP)\n- updated_at (TIMESTAMP)\n- status (TEXT)\n- metadata (TEXT)\n\n表 \'transactions\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- amount (REAL)\n- type (TEXT)\n- timestamp (TIMESTAMP)\n- description (TEXT)\n- metadata (TEXT)\n\n表 \'analysis_results\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- timestamp (TIMESTAMP)\n- result_type (TEXT)\n- result_data (TEXT)\n- metadata (TEXT)\n\n样本数据:\n\n表 \'accounts\' 样本数据 (前5条):\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]...\n\n表 \'transactions\' 样本数据 (前5条):\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]...\n\n表 \'analysis_results\' 样本数据 (前5条):\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]...\n\n        请提供以下分析:\n        1. 数据库结构分析：评估表之间的关系和设计模式\n        2. 数据质量分析：识别潜在的数据质量问题\n        3. 数据模式和趋势：识别数据中的模式和趋势\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:10:04.390 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API，使用模型: deepseek-chat...
2025-04-04 23:10:04.514 | DEBUG    | __main__:generate:109 - API响应状态码: 400
2025-04-04 23:10:04.514 | DEBUG    | __main__:generate:110 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:10:04.514 | WARNING  | __main__:generate:120 - 使用模型 deepseek-chat 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:10:04.514 | WARNING  | __main__:generate:126 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:10:04.514 | INFO     | __main__:generate:84 - 尝试使用模型: deepseek-v2
2025-04-04 23:10:04.515 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:10:04.515 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-v2', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和内容，提供深入的见解。\n        \n        数据库名称: account_data.db\n        \n        数据库包含以下表:\n        accounts, transactions, analysis_results\n        \n        表结构:\n        \n表 \'accounts\' 结构:\n- id (TEXT)\n- name (TEXT)\n- created_at (TIMESTAMP)\n- updated_at (TIMESTAMP)\n- status (TEXT)\n- metadata (TEXT)\n\n表 \'transactions\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- amount (REAL)\n- type (TEXT)\n- timestamp (TIMESTAMP)\n- description (TEXT)\n- metadata (TEXT)\n\n表 \'analysis_results\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- timestamp (TIMESTAMP)\n- result_type (TEXT)\n- result_data (TEXT)\n- metadata (TEXT)\n\n样本数据:\n\n表 \'accounts\' 样本数据 (前5条):\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]...\n\n表 \'transactions\' 样本数据 (前5条):\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]...\n\n表 \'analysis_results\' 样本数据 (前5条):\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]...\n\n        请提供以下分析:\n        1. 数据库结构分析：评估表之间的关系和设计模式\n        2. 数据质量分析：识别潜在的数据质量问题\n        3. 数据模式和趋势：识别数据中的模式和趋势\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:10:04.515 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API，使用模型: deepseek-v2...
2025-04-04 23:10:04.668 | DEBUG    | __main__:generate:109 - API响应状态码: 400
2025-04-04 23:10:04.668 | DEBUG    | __main__:generate:110 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:10:04.669 | WARNING  | __main__:generate:120 - 使用模型 deepseek-v2 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:10:04.669 | WARNING  | __main__:generate:126 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:10:04.669 | INFO     | __main__:generate:84 - 尝试使用模型: deepseek-llm
2025-04-04 23:10:04.669 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:10:04.669 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-llm', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和内容，提供深入的见解。\n        \n        数据库名称: account_data.db\n        \n        数据库包含以下表:\n        accounts, transactions, analysis_results\n        \n        表结构:\n        \n表 \'accounts\' 结构:\n- id (TEXT)\n- name (TEXT)\n- created_at (TIMESTAMP)\n- updated_at (TIMESTAMP)\n- status (TEXT)\n- metadata (TEXT)\n\n表 \'transactions\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- amount (REAL)\n- type (TEXT)\n- timestamp (TIMESTAMP)\n- description (TEXT)\n- metadata (TEXT)\n\n表 \'analysis_results\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- timestamp (TIMESTAMP)\n- result_type (TEXT)\n- result_data (TEXT)\n- metadata (TEXT)\n\n样本数据:\n\n表 \'accounts\' 样本数据 (前5条):\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]...\n\n表 \'transactions\' 样本数据 (前5条):\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]...\n\n表 \'analysis_results\' 样本数据 (前5条):\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]...\n\n        请提供以下分析:\n        1. 数据库结构分析：评估表之间的关系和设计模式\n        2. 数据质量分析：识别潜在的数据质量问题\n        3. 数据模式和趋势：识别数据中的模式和趋势\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:10:04.669 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API，使用模型: deepseek-llm...
2025-04-04 23:10:04.797 | DEBUG    | __main__:generate:109 - API响应状态码: 400
2025-04-04 23:10:04.797 | DEBUG    | __main__:generate:110 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:10:04.797 | WARNING  | __main__:generate:120 - 使用模型 deepseek-llm 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:10:04.798 | WARNING  | __main__:generate:126 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:10:04.798 | INFO     | __main__:generate:84 - 尝试使用模型: deepseek-coder
2025-04-04 23:10:04.798 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:10:04.798 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-coder', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和内容，提供深入的见解。\n        \n        数据库名称: account_data.db\n        \n        数据库包含以下表:\n        accounts, transactions, analysis_results\n        \n        表结构:\n        \n表 \'accounts\' 结构:\n- id (TEXT)\n- name (TEXT)\n- created_at (TIMESTAMP)\n- updated_at (TIMESTAMP)\n- status (TEXT)\n- metadata (TEXT)\n\n表 \'transactions\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- amount (REAL)\n- type (TEXT)\n- timestamp (TIMESTAMP)\n- description (TEXT)\n- metadata (TEXT)\n\n表 \'analysis_results\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- timestamp (TIMESTAMP)\n- result_type (TEXT)\n- result_data (TEXT)\n- metadata (TEXT)\n\n样本数据:\n\n表 \'accounts\' 样本数据 (前5条):\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]...\n\n表 \'transactions\' 样本数据 (前5条):\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]...\n\n表 \'analysis_results\' 样本数据 (前5条):\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]...\n\n        请提供以下分析:\n        1. 数据库结构分析：评估表之间的关系和设计模式\n        2. 数据质量分析：识别潜在的数据质量问题\n        3. 数据模式和趋势：识别数据中的模式和趋势\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:10:04.798 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API，使用模型: deepseek-coder...
2025-04-04 23:10:04.949 | DEBUG    | __main__:generate:109 - API响应状态码: 400
2025-04-04 23:10:04.950 | DEBUG    | __main__:generate:110 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:10:04.950 | WARNING  | __main__:generate:120 - 使用模型 deepseek-coder 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:10:04.950 | WARNING  | __main__:generate:126 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:10:04.950 | INFO     | __main__:generate:84 - 尝试使用模型: deepseek-r1
2025-04-04 23:10:04.950 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:10:04.950 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-r1', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和内容，提供深入的见解。\n        \n        数据库名称: account_data.db\n        \n        数据库包含以下表:\n        accounts, transactions, analysis_results\n        \n        表结构:\n        \n表 \'accounts\' 结构:\n- id (TEXT)\n- name (TEXT)\n- created_at (TIMESTAMP)\n- updated_at (TIMESTAMP)\n- status (TEXT)\n- metadata (TEXT)\n\n表 \'transactions\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- amount (REAL)\n- type (TEXT)\n- timestamp (TIMESTAMP)\n- description (TEXT)\n- metadata (TEXT)\n\n表 \'analysis_results\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- timestamp (TIMESTAMP)\n- result_type (TEXT)\n- result_data (TEXT)\n- metadata (TEXT)\n\n样本数据:\n\n表 \'accounts\' 样本数据 (前5条):\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]...\n\n表 \'transactions\' 样本数据 (前5条):\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]...\n\n表 \'analysis_results\' 样本数据 (前5条):\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]...\n\n        请提供以下分析:\n        1. 数据库结构分析：评估表之间的关系和设计模式\n        2. 数据质量分析：识别潜在的数据质量问题\n        3. 数据模式和趋势：识别数据中的模式和趋势\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:10:04.950 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API，使用模型: deepseek-r1...
2025-04-04 23:10:05.134 | DEBUG    | __main__:generate:109 - API响应状态码: 400
2025-04-04 23:10:05.134 | DEBUG    | __main__:generate:110 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:10:05.134 | WARNING  | __main__:generate:120 - 使用模型 deepseek-r1 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:10:05.134 | WARNING  | __main__:generate:126 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:10:05.135 | INFO     | __main__:main:966 - 数据库分析成功
2025-04-04 23:10:05.135 | INFO     | __main__:main:972 - 分析报告已保存到: /Users/aladam/Desktop/langgraph-demo/database_analysis_report.md
2025-04-04 23:10:05.135 | INFO     | __main__:main:985 - 开始分析账户 1...
2025-04-04 23:10:05.561 | INFO     | __main__:analyze_data:529 - 调用大模型API...
2025-04-04 23:10:05.561 | INFO     | __main__:generate:84 - 尝试使用模型: deepseek-chat
2025-04-04 23:10:05.561 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:10:05.561 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-chat', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:10:05.561 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API，使用模型: deepseek-chat...
2025-04-04 23:10:05.734 | DEBUG    | __main__:generate:109 - API响应状态码: 400
2025-04-04 23:10:05.735 | DEBUG    | __main__:generate:110 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:10:05.735 | WARNING  | __main__:generate:120 - 使用模型 deepseek-chat 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:10:05.735 | WARNING  | __main__:generate:126 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:10:05.735 | INFO     | __main__:generate:84 - 尝试使用模型: deepseek-v2
2025-04-04 23:10:05.735 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:10:05.735 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-v2', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:10:05.736 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API，使用模型: deepseek-v2...
2025-04-04 23:10:05.894 | DEBUG    | __main__:generate:109 - API响应状态码: 400
2025-04-04 23:10:05.894 | DEBUG    | __main__:generate:110 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:10:05.894 | WARNING  | __main__:generate:120 - 使用模型 deepseek-v2 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:10:05.894 | WARNING  | __main__:generate:126 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:10:05.895 | INFO     | __main__:generate:84 - 尝试使用模型: deepseek-llm
2025-04-04 23:10:05.895 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:10:05.895 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-llm', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:10:05.895 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API，使用模型: deepseek-llm...
2025-04-04 23:10:06.052 | DEBUG    | __main__:generate:109 - API响应状态码: 400
2025-04-04 23:10:06.052 | DEBUG    | __main__:generate:110 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:10:06.052 | WARNING  | __main__:generate:120 - 使用模型 deepseek-llm 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:10:06.052 | WARNING  | __main__:generate:126 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:10:06.052 | INFO     | __main__:generate:84 - 尝试使用模型: deepseek-coder
2025-04-04 23:10:06.053 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:10:06.053 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-coder', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:10:06.053 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API，使用模型: deepseek-coder...
2025-04-04 23:10:06.202 | DEBUG    | __main__:generate:109 - API响应状态码: 400
2025-04-04 23:10:06.202 | DEBUG    | __main__:generate:110 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:10:06.202 | WARNING  | __main__:generate:120 - 使用模型 deepseek-coder 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:10:06.202 | WARNING  | __main__:generate:126 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:10:06.202 | INFO     | __main__:generate:84 - 尝试使用模型: deepseek-r1
2025-04-04 23:10:06.202 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:10:06.203 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-r1', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:10:06.203 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API，使用模型: deepseek-r1...
2025-04-04 23:10:06.357 | DEBUG    | __main__:generate:109 - API响应状态码: 400
2025-04-04 23:10:06.357 | DEBUG    | __main__:generate:110 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:10:06.357 | WARNING  | __main__:generate:120 - 使用模型 deepseek-r1 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:10:06.357 | WARNING  | __main__:generate:126 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:10:06.357 | INFO     | __main__:main:1024 - 账户 1 分析成功
2025-04-04 23:10:06.358 | INFO     | __main__:main:1030 - 账户分析报告已保存到: /Users/aladam/Desktop/langgraph-demo/account_1_analysis_report.md
2025-04-04 23:10:06.358 | INFO     | __main__:main:1038 - 账户交易图表已保存到: /Users/aladam/Desktop/langgraph-demo/account_1_chart.png
2025-04-04 23:10:06.359 | INFO     | __main__:close:219 - 数据库连接已关闭
2025-04-04 23:10:06.359 | INFO     | __main__:main:1061 - 分析完成
2025-04-04 23:12:42.881 | INFO     | __main__:main:726 - 开始分析数据库...
2025-04-04 23:12:42.882 | INFO     | __main__:main:730 - 数据库路径: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 23:12:42.883 | INFO     | __main__:__init__:213 - 已连接到数据库: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 23:12:42.884 | INFO     | __main__:__init__:55 - 初始化DeepSeek-R1模型，API基础URL: https://api.siliconflow.cn/v1
2025-04-04 23:12:42.884 | INFO     | __main__:__init__:511 - 初始化大模型分析器完成
2025-04-04 23:12:42.884 | INFO     | __main__:main:743 - 开始分析整个数据库...
2025-04-04 23:12:42.885 | INFO     | __main__:analyze_data:529 - 调用大模型API...
2025-04-04 23:12:42.885 | INFO     | __main__:generate:84 - 尝试使用模型: deepseek-chat
2025-04-04 23:12:42.885 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:12:42.885 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-chat', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和内容，提供深入的见解。\n        \n        数据库名称: account_data.db\n        \n        数据库包含以下表:\n        accounts, transactions, analysis_results\n        \n        表结构:\n        \n表 \'accounts\' 结构:\n- id (TEXT)\n- name (TEXT)\n- created_at (TIMESTAMP)\n- updated_at (TIMESTAMP)\n- status (TEXT)\n- metadata (TEXT)\n\n表 \'transactions\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- amount (REAL)\n- type (TEXT)\n- timestamp (TIMESTAMP)\n- description (TEXT)\n- metadata (TEXT)\n\n表 \'analysis_results\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- timestamp (TIMESTAMP)\n- result_type (TEXT)\n- result_data (TEXT)\n- metadata (TEXT)\n\n样本数据:\n\n表 \'accounts\' 样本数据 (前5条):\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]...\n\n表 \'transactions\' 样本数据 (前5条):\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]...\n\n表 \'analysis_results\' 样本数据 (前5条):\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]...\n\n        请提供以下分析:\n        1. 数据库结构分析：评估表之间的关系和设计模式\n        2. 数据质量分析：识别潜在的数据质量问题\n        3. 数据模式和趋势：识别数据中的模式和趋势\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:12:42.885 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API，使用模型: deepseek-chat...
2025-04-04 23:12:43.087 | DEBUG    | __main__:generate:109 - API响应状态码: 400
2025-04-04 23:12:43.087 | DEBUG    | __main__:generate:110 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:12:43.087 | WARNING  | __main__:generate:120 - 使用模型 deepseek-chat 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:12:43.087 | WARNING  | __main__:generate:126 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:12:43.087 | INFO     | __main__:generate:84 - 尝试使用模型: deepseek-v2
2025-04-04 23:12:43.087 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:12:43.088 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-v2', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和内容，提供深入的见解。\n        \n        数据库名称: account_data.db\n        \n        数据库包含以下表:\n        accounts, transactions, analysis_results\n        \n        表结构:\n        \n表 \'accounts\' 结构:\n- id (TEXT)\n- name (TEXT)\n- created_at (TIMESTAMP)\n- updated_at (TIMESTAMP)\n- status (TEXT)\n- metadata (TEXT)\n\n表 \'transactions\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- amount (REAL)\n- type (TEXT)\n- timestamp (TIMESTAMP)\n- description (TEXT)\n- metadata (TEXT)\n\n表 \'analysis_results\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- timestamp (TIMESTAMP)\n- result_type (TEXT)\n- result_data (TEXT)\n- metadata (TEXT)\n\n样本数据:\n\n表 \'accounts\' 样本数据 (前5条):\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]...\n\n表 \'transactions\' 样本数据 (前5条):\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]...\n\n表 \'analysis_results\' 样本数据 (前5条):\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]...\n\n        请提供以下分析:\n        1. 数据库结构分析：评估表之间的关系和设计模式\n        2. 数据质量分析：识别潜在的数据质量问题\n        3. 数据模式和趋势：识别数据中的模式和趋势\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:12:43.088 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API，使用模型: deepseek-v2...
2025-04-04 23:12:43.209 | DEBUG    | __main__:generate:109 - API响应状态码: 400
2025-04-04 23:12:43.209 | DEBUG    | __main__:generate:110 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:12:43.209 | WARNING  | __main__:generate:120 - 使用模型 deepseek-v2 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:12:43.209 | WARNING  | __main__:generate:126 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:12:43.210 | INFO     | __main__:generate:84 - 尝试使用模型: deepseek-llm
2025-04-04 23:12:43.210 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:12:43.210 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-llm', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和内容，提供深入的见解。\n        \n        数据库名称: account_data.db\n        \n        数据库包含以下表:\n        accounts, transactions, analysis_results\n        \n        表结构:\n        \n表 \'accounts\' 结构:\n- id (TEXT)\n- name (TEXT)\n- created_at (TIMESTAMP)\n- updated_at (TIMESTAMP)\n- status (TEXT)\n- metadata (TEXT)\n\n表 \'transactions\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- amount (REAL)\n- type (TEXT)\n- timestamp (TIMESTAMP)\n- description (TEXT)\n- metadata (TEXT)\n\n表 \'analysis_results\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- timestamp (TIMESTAMP)\n- result_type (TEXT)\n- result_data (TEXT)\n- metadata (TEXT)\n\n样本数据:\n\n表 \'accounts\' 样本数据 (前5条):\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]...\n\n表 \'transactions\' 样本数据 (前5条):\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]...\n\n表 \'analysis_results\' 样本数据 (前5条):\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]...\n\n        请提供以下分析:\n        1. 数据库结构分析：评估表之间的关系和设计模式\n        2. 数据质量分析：识别潜在的数据质量问题\n        3. 数据模式和趋势：识别数据中的模式和趋势\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:12:43.210 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API，使用模型: deepseek-llm...
2025-04-04 23:12:43.360 | DEBUG    | __main__:generate:109 - API响应状态码: 400
2025-04-04 23:12:43.360 | DEBUG    | __main__:generate:110 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:12:43.360 | WARNING  | __main__:generate:120 - 使用模型 deepseek-llm 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:12:43.360 | WARNING  | __main__:generate:126 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:12:43.361 | INFO     | __main__:generate:84 - 尝试使用模型: deepseek-coder
2025-04-04 23:12:43.361 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:12:43.361 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-coder', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和内容，提供深入的见解。\n        \n        数据库名称: account_data.db\n        \n        数据库包含以下表:\n        accounts, transactions, analysis_results\n        \n        表结构:\n        \n表 \'accounts\' 结构:\n- id (TEXT)\n- name (TEXT)\n- created_at (TIMESTAMP)\n- updated_at (TIMESTAMP)\n- status (TEXT)\n- metadata (TEXT)\n\n表 \'transactions\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- amount (REAL)\n- type (TEXT)\n- timestamp (TIMESTAMP)\n- description (TEXT)\n- metadata (TEXT)\n\n表 \'analysis_results\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- timestamp (TIMESTAMP)\n- result_type (TEXT)\n- result_data (TEXT)\n- metadata (TEXT)\n\n样本数据:\n\n表 \'accounts\' 样本数据 (前5条):\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]...\n\n表 \'transactions\' 样本数据 (前5条):\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]...\n\n表 \'analysis_results\' 样本数据 (前5条):\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]...\n\n        请提供以下分析:\n        1. 数据库结构分析：评估表之间的关系和设计模式\n        2. 数据质量分析：识别潜在的数据质量问题\n        3. 数据模式和趋势：识别数据中的模式和趋势\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:12:43.361 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API，使用模型: deepseek-coder...
2025-04-04 23:12:43.511 | DEBUG    | __main__:generate:109 - API响应状态码: 400
2025-04-04 23:12:43.511 | DEBUG    | __main__:generate:110 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:12:43.511 | WARNING  | __main__:generate:120 - 使用模型 deepseek-coder 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:12:43.511 | WARNING  | __main__:generate:126 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:12:43.511 | INFO     | __main__:generate:84 - 尝试使用模型: deepseek-r1
2025-04-04 23:12:43.511 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:12:43.511 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-r1', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和内容，提供深入的见解。\n        \n        数据库名称: account_data.db\n        \n        数据库包含以下表:\n        accounts, transactions, analysis_results\n        \n        表结构:\n        \n表 \'accounts\' 结构:\n- id (TEXT)\n- name (TEXT)\n- created_at (TIMESTAMP)\n- updated_at (TIMESTAMP)\n- status (TEXT)\n- metadata (TEXT)\n\n表 \'transactions\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- amount (REAL)\n- type (TEXT)\n- timestamp (TIMESTAMP)\n- description (TEXT)\n- metadata (TEXT)\n\n表 \'analysis_results\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- timestamp (TIMESTAMP)\n- result_type (TEXT)\n- result_data (TEXT)\n- metadata (TEXT)\n\n样本数据:\n\n表 \'accounts\' 样本数据 (前5条):\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]...\n\n表 \'transactions\' 样本数据 (前5条):\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]...\n\n表 \'analysis_results\' 样本数据 (前5条):\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]...\n\n        请提供以下分析:\n        1. 数据库结构分析：评估表之间的关系和设计模式\n        2. 数据质量分析：识别潜在的数据质量问题\n        3. 数据模式和趋势：识别数据中的模式和趋势\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:12:43.512 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API，使用模型: deepseek-r1...
2025-04-04 23:12:43.729 | DEBUG    | __main__:generate:109 - API响应状态码: 400
2025-04-04 23:12:43.729 | DEBUG    | __main__:generate:110 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:12:43.730 | WARNING  | __main__:generate:120 - 使用模型 deepseek-r1 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:12:43.730 | WARNING  | __main__:generate:126 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:12:43.730 | INFO     | __main__:main:747 - 数据库分析成功
2025-04-04 23:12:43.731 | INFO     | __main__:main:753 - 分析报告已保存到: /Users/aladam/Desktop/langgraph-demo/database_analysis_report.md
2025-04-04 23:12:43.731 | INFO     | __main__:main:766 - 开始分析账户 1...
2025-04-04 23:12:44.157 | INFO     | __main__:analyze_data:529 - 调用大模型API...
2025-04-04 23:12:44.157 | INFO     | __main__:generate:84 - 尝试使用模型: deepseek-chat
2025-04-04 23:12:44.157 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:12:44.157 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-chat', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:12:44.157 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API，使用模型: deepseek-chat...
2025-04-04 23:12:44.346 | DEBUG    | __main__:generate:109 - API响应状态码: 400
2025-04-04 23:12:44.346 | DEBUG    | __main__:generate:110 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:12:44.346 | WARNING  | __main__:generate:120 - 使用模型 deepseek-chat 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:12:44.346 | WARNING  | __main__:generate:126 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:12:44.346 | INFO     | __main__:generate:84 - 尝试使用模型: deepseek-v2
2025-04-04 23:12:44.347 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:12:44.347 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-v2', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:12:44.347 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API，使用模型: deepseek-v2...
2025-04-04 23:12:44.463 | DEBUG    | __main__:generate:109 - API响应状态码: 400
2025-04-04 23:12:44.463 | DEBUG    | __main__:generate:110 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:12:44.463 | WARNING  | __main__:generate:120 - 使用模型 deepseek-v2 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:12:44.464 | WARNING  | __main__:generate:126 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:12:44.464 | INFO     | __main__:generate:84 - 尝试使用模型: deepseek-llm
2025-04-04 23:12:44.464 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:12:44.464 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-llm', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:12:44.464 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API，使用模型: deepseek-llm...
2025-04-04 23:12:44.652 | DEBUG    | __main__:generate:109 - API响应状态码: 400
2025-04-04 23:12:44.653 | DEBUG    | __main__:generate:110 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:12:44.653 | WARNING  | __main__:generate:120 - 使用模型 deepseek-llm 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:12:44.653 | WARNING  | __main__:generate:126 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:12:44.653 | INFO     | __main__:generate:84 - 尝试使用模型: deepseek-coder
2025-04-04 23:12:44.653 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:12:44.653 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-coder', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:12:44.654 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API，使用模型: deepseek-coder...
2025-04-04 23:12:44.797 | DEBUG    | __main__:generate:109 - API响应状态码: 400
2025-04-04 23:12:44.797 | DEBUG    | __main__:generate:110 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:12:44.797 | WARNING  | __main__:generate:120 - 使用模型 deepseek-coder 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:12:44.797 | WARNING  | __main__:generate:126 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:12:44.797 | INFO     | __main__:generate:84 - 尝试使用模型: deepseek-r1
2025-04-04 23:12:44.797 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:12:44.798 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-r1', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:12:44.798 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API，使用模型: deepseek-r1...
2025-04-04 23:12:44.947 | DEBUG    | __main__:generate:109 - API响应状态码: 400
2025-04-04 23:12:44.948 | DEBUG    | __main__:generate:110 - API响应内容: {"code":20012,"message":"Model does not exist. Please check it carefully.","data":null}...
2025-04-04 23:12:44.948 | WARNING  | __main__:generate:120 - 使用模型 deepseek-r1 请求失败: 400 Client Error: Bad Request for url: https://api.siliconflow.cn/v1/chat/completions
2025-04-04 23:12:44.948 | WARNING  | __main__:generate:126 - API错误详情: {'code': 20012, 'message': 'Model does not exist. Please check it carefully.', 'data': None}
2025-04-04 23:12:44.948 | INFO     | __main__:main:805 - 账户 1 分析成功
2025-04-04 23:12:44.948 | INFO     | __main__:main:811 - 账户分析报告已保存到: /Users/aladam/Desktop/langgraph-demo/account_1_analysis_report.md
2025-04-04 23:12:44.949 | INFO     | __main__:main:819 - 账户交易图表已保存到: /Users/aladam/Desktop/langgraph-demo/account_1_chart.png
2025-04-04 23:12:44.949 | INFO     | __main__:close:219 - 数据库连接已关闭
2025-04-04 23:12:44.949 | INFO     | __main__:main:842 - 分析完成
2025-04-04 23:14:54.627 | INFO     | __main__:main:721 - 开始分析数据库...
2025-04-04 23:14:54.628 | INFO     | __main__:main:725 - 数据库路径: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 23:14:54.628 | INFO     | __main__:__init__:205 - 已连接到数据库: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 23:14:54.629 | INFO     | __main__:__init__:55 - 初始化DeepSeek-R1模型，API基础URL: https://api.siliconflow.cn/v1
2025-04-04 23:14:54.630 | INFO     | __main__:__init__:503 - 初始化大模型分析器完成
2025-04-04 23:14:54.630 | INFO     | __main__:main:738 - 开始分析整个数据库...
2025-04-04 23:14:54.630 | INFO     | __main__:analyze_data:521 - 调用大模型API...
2025-04-04 23:14:54.630 | ERROR    | __main__:analyze_data:531 - 分析过程中出错: 'DeepSeekR1' object has no attribute 'config'
2025-04-04 23:14:54.632 | ERROR    | __main__:analyze_data:532 - Traceback (most recent call last):
  File "/Users/aladam/Desktop/langgraph-demo/src/main.py", line 523, in analyze_data
    analysis = self.model.generate(messages)
  File "/Users/aladam/Desktop/langgraph-demo/src/main.py", line 80, in generate
    model_name = self.config.get("llm_model", "deepseek-ai/DeepSeek-R1")
                 ^^^^^^^^^^^
AttributeError: 'DeepSeekR1' object has no attribute 'config'

2025-04-04 23:14:54.632 | ERROR    | __main__:main:750 - 数据库分析失败: 'DeepSeekR1' object has no attribute 'config'
2025-04-04 23:14:54.633 | INFO     | __main__:main:757 - 模拟分析报告已保存到: /Users/aladam/Desktop/langgraph-demo/database_analysis_report_mock.md
2025-04-04 23:14:54.633 | INFO     | __main__:main:761 - 开始分析账户 1...
2025-04-04 23:14:55.077 | INFO     | __main__:analyze_data:521 - 调用大模型API...
2025-04-04 23:14:55.077 | ERROR    | __main__:analyze_data:531 - 分析过程中出错: 'DeepSeekR1' object has no attribute 'config'
2025-04-04 23:14:55.077 | ERROR    | __main__:analyze_data:532 - Traceback (most recent call last):
  File "/Users/aladam/Desktop/langgraph-demo/src/main.py", line 523, in analyze_data
    analysis = self.model.generate(messages)
  File "/Users/aladam/Desktop/langgraph-demo/src/main.py", line 80, in generate
    model_name = self.config.get("llm_model", "deepseek-ai/DeepSeek-R1")
                 ^^^^^^^^^^^
AttributeError: 'DeepSeekR1' object has no attribute 'config'

2025-04-04 23:14:55.078 | ERROR    | __main__:main:816 - 账户 1 分析失败: 'DeepSeekR1' object has no attribute 'config'
2025-04-04 23:14:55.078 | INFO     | __main__:main:823 - 账户模拟分析报告已保存到: /Users/aladam/Desktop/langgraph-demo/account_1_analysis_report_mock.md
2025-04-04 23:14:55.078 | INFO     | __main__:close:211 - 数据库连接已关闭
2025-04-04 23:14:55.078 | INFO     | __main__:main:837 - 分析完成
2025-04-04 23:15:53.749 | INFO     | __main__:main:723 - 开始分析数据库...
2025-04-04 23:15:53.750 | INFO     | __main__:main:727 - 数据库路径: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 23:15:53.750 | INFO     | __main__:__init__:206 - 已连接到数据库: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 23:15:53.752 | INFO     | __main__:__init__:56 - 初始化DeepSeek-R1模型，API基础URL: https://api.siliconflow.cn/v1
2025-04-04 23:15:53.752 | INFO     | __main__:__init__:505 - 初始化大模型分析器完成
2025-04-04 23:15:53.752 | INFO     | __main__:main:740 - 开始分析整个数据库...
2025-04-04 23:15:53.752 | INFO     | __main__:analyze_data:523 - 调用大模型API...
2025-04-04 23:15:53.753 | INFO     | __main__:generate:84 - 使用模型: deepseek-ai/DeepSeek-V2.5
2025-04-04 23:15:53.753 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:15:53.753 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-ai/DeepSeek-V2.5', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和内容，提供深入的见解。\n        \n        数据库名称: account_data.db\n        \n        数据库包含以下表:\n        accounts, transactions, analysis_results\n        \n        表结构:\n        \n表 \'accounts\' 结构:\n- id (TEXT)\n- name (TEXT)\n- created_at (TIMESTAMP)\n- updated_at (TIMESTAMP)\n- status (TEXT)\n- metadata (TEXT)\n\n表 \'transactions\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- amount (REAL)\n- type (TEXT)\n- timestamp (TIMESTAMP)\n- description (TEXT)\n- metadata (TEXT)\n\n表 \'analysis_results\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- timestamp (TIMESTAMP)\n- result_type (TEXT)\n- result_data (TEXT)\n- metadata (TEXT)\n\n样本数据:\n\n表 \'accounts\' 样本数据 (前5条):\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]...\n\n表 \'transactions\' 样本数据 (前5条):\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]...\n\n表 \'analysis_results\' 样本数据 (前5条):\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]...\n\n        请提供以下分析:\n        1. 数据库结构分析：评估表之间的关系和设计模式\n        2. 数据质量分析：识别潜在的数据质量问题\n        3. 数据模式和趋势：识别数据中的模式和趋势\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:15:53.753 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API...
2025-04-04 23:16:48.924 | DEBUG    | __main__:generate:109 - API响应状态码: 200
2025-04-04 23:16:48.925 | DEBUG    | __main__:generate:110 - API响应内容: {"id":"0196015f7036a470c1e808d63bf9b514","object":"chat.completion","created":1743779754,"model":"deepseek-ai/DeepSeek-V2.5","choices":[{"index":0,"message":{"role":"assistant","content":"### 1. 数据库结构分析\n\n#### 表之间的关系和设计模式\n\n- **accounts 表**: 该表存储了账户的基本信息，包括账户的唯一标识符 `id`、账户名称 `name`、创建和更新时间 `created_at` 和 `updated_at`、账户状态 `status` 以及元数据 `metadata`。这个表是整个数据库的核心，其他表（如 `transactions` 和 `analysis_results`）都通过 `account_id` 与 `accounts` 表关联。\n\n- **transactions 表**: 该表记录了与账户相关的交易信息，包括交易的唯一标识符 `id`、关...
2025-04-04 23:16:48.925 | INFO     | __main__:generate:115 - 成功使用模型 deepseek-ai/DeepSeek-V2.5
2025-04-04 23:16:48.925 | INFO     | __main__:main:744 - 数据库分析成功
2025-04-04 23:16:48.926 | INFO     | __main__:main:750 - 分析报告已保存到: /Users/aladam/Desktop/langgraph-demo/database_analysis_report.md
2025-04-04 23:16:48.926 | INFO     | __main__:main:763 - 开始分析账户 1...
2025-04-04 23:16:49.390 | INFO     | __main__:analyze_data:523 - 调用大模型API...
2025-04-04 23:16:49.390 | INFO     | __main__:generate:84 - 使用模型: deepseek-ai/DeepSeek-V2.5
2025-04-04 23:16:49.390 | DEBUG    | __main__:generate:96 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:16:49.390 | DEBUG    | __main__:generate:97 - API请求体: {'model': 'deepseek-ai/DeepSeek-V2.5', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n            你是一个数据分析专家，请分析以下账户数据并提供见解。\n            \n            账户ID: 1\n            \n            交易数据:\n            [\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "bb0022b6-dcd1-432d-b2e1-6eaf63a4f75f",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-21",\n    "metadata": {\n      "date": "2025-02-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "eae88d72-99e8-4cd9-85a9-11e3837831eb",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-01",\n    "metadata": {\n      "date": "2025-03-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 3.4,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "1e108f2a-aacc-4bab-b3f7-ad500c7d8c35",\n    "account_id": "1",\n    "amount": 6.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-11",\n    "metadata": {\n      "date": "2025-03-11",\n      "metric1": 6,\n      "metric2": 5,\n      "metric3": 3.4,\n      "metric4": 5,\n      "metric5": 5,\n      "metric6": 5\n    }\n  },\n  {\n    "id": "9d43e101-217f-4d62-acfd-9944797346f1",\n    "account_id": "1",\n    "amount": 12.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-03-21",\n    "metadata": {\n      "date": "2025-03-21",\n      "metric1": 12,\n      "metric2": 6,\n      "metric3": 3.4,\n      "metric4": 6,\n      "metric5": 6,\n      "metric6": 6\n    }\n  },\n  {\n    "id": "83d197de-8e87-4ecc-a85c-c6cf1668e310",\n    "account_id": "1",\n    "amount": 24.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-04-01",\n    "metadata": {\n      "date": "2025-04-01",\n      "metric1": 24,\n      "metric2": 12,\n      "metric3": 3.4,\n      "metric4": 12,\n      "metric5": 12,\n      "metric6": 12\n    }\n  }\n]\n            \n            历史分析结果:\n            [\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]\n            \n            请提供以下分析:\n            1. 账户概述：基本信息和活动摘要\n            2. 交易模式分析：识别交易模式、趋势和异常\n            3. 指标分析：分析各项指标的变化和相关性\n            4. 风险评估：评估账户的潜在风险和问题\n            5. 建议：针对该账户的具体建议\n            \n            请以结构化的方式提供你的分析，使用标题和小节组织内容。\n            '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:16:49.390 | INFO     | __main__:generate:99 - 发送请求到DeepSeek API...
2025-04-04 23:17:29.605 | DEBUG    | __main__:generate:109 - API响应状态码: 200
2025-04-04 23:17:29.605 | DEBUG    | __main__:generate:110 - API响应内容: {"id":"0196016049914100fc05bd721ea6e914","object":"chat.completion","created":1743779809,"model":"deepseek-ai/DeepSeek-V2.5","choices":[{"index":0,"message":{"role":"assistant","content":"### 1. 账户概述\n\n#### 基本信息\n- **账户ID**: 1\n- **交易数据时间范围**: 2025-01-01 至 2025-04-01\n- **交易记录数量**: 10\n- **交易类型**: 全部为 `data_entry` 类型\n\n#### 活动摘要\n- **交易频率**: 每10天记录一次数据，从2025年1月1日开始，直到2025年4月1日。\n- **交易金额**: 初始交易金额为1.0，逐步增加至24.0。\n- **指标变化**: 从2025年3月开始，多个指标（metric1, metric2, metric4, metric5, metric6）从0上升到较高值。...
2025-04-04 23:17:29.605 | INFO     | __main__:generate:115 - 成功使用模型 deepseek-ai/DeepSeek-V2.5
2025-04-04 23:17:29.606 | INFO     | __main__:main:802 - 账户 1 分析成功
2025-04-04 23:17:29.606 | INFO     | __main__:main:808 - 账户分析报告已保存到: /Users/aladam/Desktop/langgraph-demo/account_1_analysis_report.md
2025-04-04 23:17:29.607 | INFO     | __main__:main:816 - 账户交易图表已保存到: /Users/aladam/Desktop/langgraph-demo/account_1_chart.png
2025-04-04 23:17:29.607 | INFO     | __main__:close:212 - 数据库连接已关闭
2025-04-04 23:17:29.607 | INFO     | __main__:main:839 - 分析完成
2025-04-04 23:23:49.803 | INFO     | __main__:main:583 - 开始分析数据库...
2025-04-04 23:23:49.803 | INFO     | __main__:main:587 - 数据库路径: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 23:23:49.805 | INFO     | __main__:__init__:203 - 已连接到数据库: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 23:23:49.808 | INFO     | __main__:__init__:56 - 初始化DeepSeek-R1模型，API基础URL: https://api.siliconflow.cn/v1，模型: deepseek-ai/DeepSeek-R1
2025-04-04 23:23:49.809 | INFO     | __main__:__init__:375 - 初始化大模型分析器完成
2025-04-04 23:23:49.809 | INFO     | __main__:main:600 - 开始分析整个数据库...
2025-04-04 23:23:49.809 | INFO     | __main__:analyze_data:393 - 调用大模型API...
2025-04-04 23:23:49.809 | INFO     | __main__:generate:81 - 使用模型: deepseek-ai/DeepSeek-R1
2025-04-04 23:23:49.809 | DEBUG    | __main__:generate:93 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:23:49.809 | DEBUG    | __main__:generate:94 - API请求体: {'model': 'deepseek-ai/DeepSeek-R1', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和内容，提供深入的见解。\n        \n        数据库名称: account_data.db\n        \n        数据库包含以下表:\n        accounts, transactions, analysis_results\n        \n        表结构:\n        \n表 \'accounts\' 结构:\n- id (TEXT)\n- name (TEXT)\n- created_at (TIMESTAMP)\n- updated_at (TIMESTAMP)\n- status (TEXT)\n- metadata (TEXT)\n\n表 \'transactions\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- amount (REAL)\n- type (TEXT)\n- timestamp (TIMESTAMP)\n- description (TEXT)\n- metadata (TEXT)\n\n表 \'analysis_results\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- timestamp (TIMESTAMP)\n- result_type (TEXT)\n- result_data (TEXT)\n- metadata (TEXT)\n\n样本数据:\n\n表 \'accounts\' 样本数据 (前5条):\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]...\n\n表 \'transactions\' 样本数据 (前5条):\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]...\n\n表 \'analysis_results\' 样本数据 (前5条):\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]...\n\n        请提供以下分析:\n        1. 数据库结构分析：评估表之间的关系和设计模式\n        2. 数据质量分析：识别潜在的数据质量问题\n        3. 数据模式和趋势：识别数据中的模式和趋势\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:23:49.810 | INFO     | __main__:generate:96 - 发送请求到DeepSeek API...
2025-04-04 23:24:49.933 | ERROR    | __main__:generate:117 - 使用模型 deepseek-ai/DeepSeek-R1 请求失败: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Read timed out. (read timeout=60)
2025-04-04 23:24:49.933 | INFO     | __main__:main:604 - 数据库分析成功
2025-04-04 23:24:49.934 | INFO     | __main__:main:610 - 分析报告已保存到: /Users/aladam/Desktop/langgraph-demo/database_analysis_report.md
2025-04-04 23:24:49.934 | INFO     | __main__:close:209 - 数据库连接已关闭
2025-04-04 23:24:49.934 | INFO     | __main__:main:631 - 分析完成
2025-04-04 23:28:04.181 | INFO     | __main__:main:600 - 开始分析数据库...
2025-04-04 23:28:04.181 | INFO     | __main__:main:604 - 数据库路径: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 23:28:04.182 | INFO     | __main__:__init__:211 - 已连接到数据库: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 23:28:04.183 | INFO     | __main__:__init__:56 - 初始化DeepSeek-R1模型，API基础URL: https://api.siliconflow.cn/v1，模型: deepseek-ai/DeepSeek-R1
2025-04-04 23:28:04.183 | INFO     | __main__:__init__:383 - 初始化大模型分析器完成
2025-04-04 23:28:04.183 | INFO     | __main__:main:617 - 开始分析整个数据库...
2025-04-04 23:28:04.184 | INFO     | __main__:analyze_data:401 - 调用大模型API...
2025-04-04 23:28:04.184 | INFO     | __main__:generate:81 - 使用模型: deepseek-ai/DeepSeek-R1
2025-04-04 23:28:10.835 | DEBUG    | __main__:generate:101 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:28:10.835 | DEBUG    | __main__:generate:102 - API请求体: {'model': 'deepseek-ai/DeepSeek-R1', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下数据库结构和内容，提供深入的见解。\n        \n        数据库名称: account_data.db\n        \n        数据库包含以下表:\n        accounts, transactions, analysis_results\n        \n        表结构:\n        \n表 \'accounts\' 结构:\n- id (TEXT)\n- name (TEXT)\n- created_at (TIMESTAMP)\n- updated_at (TIMESTAMP)\n- status (TEXT)\n- metadata (TEXT)\n\n表 \'transactions\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- amount (REAL)\n- type (TEXT)\n- timestamp (TIMESTAMP)\n- description (TEXT)\n- metadata (TEXT)\n\n表 \'analysis_results\' 结构:\n- id (TEXT)\n- account_id (TEXT)\n- timestamp (TIMESTAMP)\n- result_type (TEXT)\n- result_data (TEXT)\n- metadata (TEXT)\n\n样本数据:\n\n表 \'accounts\' 样本数据 (前5条):\n[\n  {\n    "id": "1",\n    "name": "时间序列测试账户",\n    "created_at": "2025-04-03 01:06:58",\n    "updated_at": "2025-04-03 01:06:58",\n    "status": "active",\n    "metadata": {\n      "description": "包含时间序列数据的测试账户",\n      "created_at": 1743642418.129614\n    }\n  }\n]...\n\n表 \'transactions\' 样本数据 (前5条):\n[\n  {\n    "id": "e6fa4dd4-9f30-41af-9f35-62fde90f31d0",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-01",\n    "metadata": {\n      "date": "2025-01-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "a2b13a54-c178-40cd-9be7-903062281e8c",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-11",\n    "metadata": {\n      "date": "2025-01-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "d43adaed-bbc7-4dae-b8e4-25d122b71617",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-01-21",\n    "metadata": {\n      "date": "2025-01-21",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "b0f841b0-8fbf-4bf5-82d7-d4d060953c51",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-01",\n    "metadata": {\n      "date": "2025-02-01",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 1.6,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  },\n  {\n    "id": "e11caa44-5fd0-4f87-ad79-0f7add0d4572",\n    "account_id": "1",\n    "amount": 1.0,\n    "type": "data_entry",\n    "timestamp": "2025-04-03 01:06:58",\n    "description": "数据记录 - 2025-02-11",\n    "metadata": {\n      "date": "2025-02-11",\n      "metric1": 1,\n      "metric2": 0,\n      "metric3": 2,\n      "metric4": 0,\n      "metric5": 0,\n      "metric6": 0\n    }\n  }\n]...\n\n表 \'analysis_results\' 样本数据 (前5条):\n[\n  {\n    "id": "06faa5ae-2108-451a-bb0b-2c75aee6f30a",\n    "account_id": "1",\n    "timestamp": "2025-04-03 01:06:58",\n    "result_type": "initial_assessment",\n    "result_data": "这是账户1的初始数据分析。数据显示在2025年3月开始有显著变化，多个指标从0上升到较高值。",\n    "metadata": {\n      "created_at": 1743642418.1469162,\n      "data_points": 10,\n      "date_range": "2025-01-01 至 2025-04-01"\n    }\n  }\n]...\n\n        请提供以下分析:\n        1. 数据库结构分析：评估表之间的关系和设计模式\n        2. 数据质量分析：识别潜在的数据质量问题\n        3. 数据模式和趋势：识别数据中的模式和趋势\n        4. 业务见解：基于数据提供业务相关的见解和建议\n        5. 改进建议：针对数据库设计和数据质量的改进建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:28:10.835 | INFO     | __main__:generate:104 - 发送请求到DeepSeek API...
2025-04-04 23:29:10.968 | ERROR    | __main__:generate:125 - 使用模型 deepseek-ai/DeepSeek-R1 请求失败: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Read timed out. (read timeout=60)
2025-04-04 23:29:10.968 | ERROR    | __main__:analyze_data:407 - API调用失败，返回了模拟回复
2025-04-04 23:29:10.969 | ERROR    | __main__:main:629 - 数据库分析失败: API调用失败
2025-04-04 23:29:10.969 | INFO     | __main__:main:636 - 模拟分析报告已保存到: /Users/aladam/Desktop/langgraph-demo/database_analysis_report_mock.md
2025-04-04 23:29:10.969 | INFO     | __main__:close:217 - 数据库连接已关闭
2025-04-04 23:29:10.970 | INFO     | __main__:main:648 - 分析完成
2025-04-04 23:33:48.049 | INFO     | __main__:main:507 - 开始分析数据库...
2025-04-04 23:33:48.049 | INFO     | __main__:main:511 - 数据库路径: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 23:33:48.050 | INFO     | __main__:__init__:211 - 已连接到数据库: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-04 23:33:48.050 | INFO     | __main__:__init__:56 - 初始化DeepSeek-R1模型，API基础URL: https://api.siliconflow.cn/v1，模型: deepseek-ai/DeepSeek-R1
2025-04-04 23:33:48.050 | INFO     | __main__:__init__:288 - 初始化大模型分析器完成
2025-04-04 23:33:48.050 | INFO     | __main__:main:524 - 开始分析整个数据库...
2025-04-04 23:33:48.051 | INFO     | __main__:analyze_data:306 - 调用大模型API...
2025-04-04 23:33:48.051 | INFO     | __main__:generate:81 - 使用模型: deepseek-ai/DeepSeek-R1
2025-04-04 23:33:55.393 | DEBUG    | __main__:generate:101 - API请求头: {'Authorization': 'Bearer sk-***', 'Content-Type': 'application/json'}
2025-04-04 23:33:55.393 | DEBUG    | __main__:generate:102 - API请求体: {'model': 'deepseek-ai/DeepSeek-R1', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下用水量数据，提供深入的见解。\n        \n        数据库名称: account_data.db\n        分析目标: 用水量数据分析\n        \n        用水量数据样本:\n        \n        请提供以下分析:\n        1. 用水模式分析：识别用水量的模式和趋势\n        2. 季节性分析：识别是否存在季节性变化\n        3. 异常检测：识别异常的用水量数据点\n        4. 账户比较：比较不同账户的用水模式\n        5. 建议：基于分析提供节水或优化用水的建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 4000}
2025-04-04 23:33:55.393 | INFO     | __main__:generate:104 - 发送请求到DeepSeek API...
2025-04-04 23:34:55.518 | ERROR    | __main__:generate:125 - 使用模型 deepseek-ai/DeepSeek-R1 请求失败: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Read timed out. (read timeout=60)
2025-04-04 23:34:55.518 | ERROR    | __main__:analyze_data:312 - API调用失败，返回了模拟回复
2025-04-04 23:34:55.518 | ERROR    | __main__:main:536 - 数据库分析失败: API调用失败
2025-04-04 23:34:55.518 | INFO     | __main__:main:543 - 模拟分析报告已保存到: /Users/aladam/Desktop/langgraph-demo/database_analysis_report_mock.md
2025-04-04 23:34:55.519 | INFO     | __main__:close:217 - 数据库连接已关闭
2025-04-04 23:34:55.519 | INFO     | __main__:main:555 - 分析完成
2025-04-05 00:01:35.988 | INFO     | __main__:main:487 - 开始分析数据库...
2025-04-05 00:01:35.989 | INFO     | __main__:main:491 - 数据库路径: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-05 00:01:35.989 | INFO     | __main__:__init__:191 - 已连接到数据库: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-05 00:01:35.989 | INFO     | __main__:__init__:56 - 初始化DeepSeek-R1模型，API基础URL: https://api.siliconflow.cn/v1，模型: deepseek-ai/DeepSeek-R1
2025-04-05 00:01:35.990 | INFO     | __main__:__init__:268 - 初始化大模型分析器完成
2025-04-05 00:01:35.990 | INFO     | __main__:main:504 - 开始分析整个数据库...
2025-04-05 00:01:35.990 | INFO     | __main__:analyze_data:286 - 调用大模型API...
2025-04-05 00:01:35.990 | DEBUG    | __main__:generate:74 - API请求体: {'model': 'deepseek-ai/DeepSeek-R1', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请分析以下用水量数据，提供深入的见解。\n        \n        数据库名称: account_data.db\n        分析目标: 用水量数据分析\n        \n        用水量数据样本:\n        \n        请提供以下分析:\n        1. 用水模式分析：识别用水量的模式和趋势\n        2. 季节性分析：识别是否存在季节性变化\n        3. 异常检测：识别异常的用水量数据点\n        4. 账户比较：比较不同账户的用水模式\n        5. 建议：基于分析提供节水或优化用水的建议\n        \n        请以结构化的方式提供你的分析，使用标题和小节组织内容。\n        '}], 'temperature': 0.3, 'max_tokens': 2000}
2025-04-05 00:01:35.990 | INFO     | __main__:generate:76 - 发送请求到DeepSeek API...
2025-04-05 00:02:36.112 | ERROR    | __main__:generate:105 - 使用模型 deepseek-ai/DeepSeek-R1 请求失败: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Read timed out. (read timeout=60)
2025-04-05 00:02:36.112 | ERROR    | __main__:analyze_data:292 - API调用失败，返回了模拟回复
2025-04-05 00:02:36.112 | ERROR    | __main__:main:516 - 数据库分析失败: API调用失败
2025-04-05 00:02:36.112 | INFO     | __main__:main:523 - 模拟分析报告已保存到: /Users/aladam/Desktop/langgraph-demo/database_analysis_report_mock.md
2025-04-05 00:02:36.113 | INFO     | __main__:close:197 - 数据库连接已关闭
2025-04-05 00:02:36.113 | INFO     | __main__:main:535 - 分析完成
2025-04-05 00:06:19.152 | INFO     | __main__:main:494 - 开始分析数据库...
2025-04-05 00:06:19.152 | INFO     | __main__:main:498 - 数据库路径: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-05 00:06:19.153 | INFO     | __main__:__init__:191 - 已连接到数据库: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-05 00:06:19.153 | INFO     | __main__:__init__:56 - 初始化DeepSeek-R1模型，API基础URL: https://api.siliconflow.cn/v1，模型: deepseek-ai/DeepSeek-R1
2025-04-05 00:06:19.153 | INFO     | __main__:__init__:268 - 初始化大模型分析器完成
2025-04-05 00:06:19.153 | INFO     | __main__:main:511 - 开始分析整个数据库...
2025-04-05 00:06:19.154 | INFO     | __main__:analyze_data:286 - 调用大模型API...
2025-04-05 00:06:19.154 | DEBUG    | __main__:generate:74 - API请求体: {'model': 'deepseek-ai/DeepSeek-R1', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请简要分析以下用水量数据，提供关键见解。请控制回复在500字以内。\n        \n        数据库名称: account_data.db\n        分析目标: 用水量数据分析\n        \n        用水量数据样本:\n        \n       角色：数据分析工程师\n你每次根据我发给你的图片进行观测，该住户是否存在漏水问题。\n说明：图片里包含抄表时间、当前止度、当前用量。\n漏水分为管道漏水、室内器具漏水。\n住户分为民居民用水和商业用水。\n居民用水存在，管道漏水、室内器具漏水。\n商业用水只存在，因平时用水较大，只有单日连续较之前增加才会判定为漏水情况。\n管楼漏水：抄表时间靠前时，当前用量会较低只有零点几，之后随着抄表时间增加当前用水会逐渐增大最终至3以上。\n室内器具漏水：分为两种，一种当前用量突然产生5以上，还有一种抄表时间每天都会都会在1方以下0.5以上。\n技能：根据图片分析数据的能力、判断时用水量异常的能力。\n\n居民用水流程：中会填写居民用水，抄表时间5天大概会使用1以下，如有管楼漏水，室内器具漏水则提示说明，如无异常则提示无异常。\n商业用水流程：中会填写商业用水，抄表时间10天大概会使用10至50之间，如果当前用量较之前增大一倍则提示漏水，反之则提示无异常。\n\n提示：我给你的是连续的每天用量，不要直接当成是一天的用量分析。\n        '}], 'temperature': 0.3, 'max_tokens': 2000}
2025-04-05 00:06:19.154 | INFO     | __main__:generate:76 - 发送请求到DeepSeek API...
2025-04-05 00:07:19.303 | ERROR    | __main__:generate:105 - 使用模型 deepseek-ai/DeepSeek-R1 请求失败: HTTPSConnectionPool(host='api.siliconflow.cn', port=443): Read timed out. (read timeout=60)
2025-04-05 00:07:19.303 | ERROR    | __main__:analyze_data:292 - API调用失败，返回了模拟回复
2025-04-05 00:07:19.304 | ERROR    | __main__:main:523 - 数据库分析失败: API调用失败
2025-04-05 00:07:19.304 | INFO     | __main__:main:530 - 模拟分析报告已保存到: /Users/aladam/Desktop/langgraph-demo/database_analysis_report_mock.md
2025-04-05 00:07:19.304 | INFO     | __main__:close:197 - 数据库连接已关闭
2025-04-05 00:07:19.304 | INFO     | __main__:main:542 - 分析完成
2025-04-05 00:08:41.130 | INFO     | __main__:main:482 - 开始分析数据库...
2025-04-05 00:08:41.130 | INFO     | __main__:main:486 - 数据库路径: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-05 00:08:41.130 | INFO     | __main__:__init__:192 - 已连接到数据库: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-05 00:08:41.131 | INFO     | __main__:__init__:56 - 初始化DeepSeek-R1模型，API基础URL: https://api.siliconflow.cn/v1，模型: deepseek-ai/DeepSeek-R1
2025-04-05 00:08:41.131 | INFO     | __main__:__init__:269 - 初始化大模型分析器完成
2025-04-05 00:08:41.131 | INFO     | __main__:main:499 - 开始分析整个数据库...
2025-04-05 00:08:41.131 | INFO     | __main__:analyze_data:287 - 调用大模型API...
2025-04-05 00:08:41.131 | DEBUG    | __main__:generate:74 - API请求体: {'model': 'deepseek-ai/DeepSeek-R1', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请简要分析以下用水量数据，提供关键见解。请控制回复在300字以内。\n        \n        数据库名称: account_data.db\n        分析目标: 用水量数据分析\n        \n        用水量数据样本:\n        \n        请提供简要分析:\n        1. 用水模式是否正常\n        2. 是否存在漏水迹象\n        \n        请保持简洁，控制回复在300字以内。\n        '}], 'temperature': 0.3, 'max_tokens': 800}
2025-04-05 00:08:41.132 | INFO     | __main__:generate:76 - 发送请求到DeepSeek API...
2025-04-05 00:10:01.717 | DEBUG    | __main__:generate:87 - API响应状态码: 200
2025-04-05 00:10:01.718 | DEBUG    | __main__:generate:88 - API响应内容: {"id":"0196018fc4a3e6d2d064e0aaaa42b609","object":"chat.completion","created":1743782922,"model":"deepseek-ai/DeepSeek-R1","choices":[{"index":0,"message":{"role":"assistant","content":"【用水模式分析】日间用水占比58%符合生活规律，但用户004夜间单次用量500升（设备关闭状态）异常突出。高峰时段整体用量合理，但用户002持续超均值2倍需核查特殊需求\n\n【漏水迹象识别】3处明确风险：1)用户003设备关闭时持续基础流量（200升/时段） 2)用户004夜间异常峰值伴随E02故障码 3)全系统凌晨1-5点平均120升/户的基底流量超正常闲置水平3倍\n\n【处置建议】优先排查004户智能水表传控故障，03户管道密封性检测，建议加装压力传感器验证凌晨基底流量真实性。4户异常用水量集中发生在最近7天，需结合维修记录交叉验证","reasoning_content":"好的，我现在需要分析用户提供的用水量...
2025-04-05 00:10:01.718 | INFO     | __main__:generate:93 - 成功使用模型 deepseek-ai/DeepSeek-R1
2025-04-05 00:10:01.718 | INFO     | __main__:main:503 - 数据库分析成功
2025-04-05 00:10:01.719 | INFO     | __main__:main:509 - 分析报告已保存到: /Users/aladam/Desktop/langgraph-demo/database_analysis_report.md
2025-04-05 00:10:01.719 | INFO     | __main__:close:198 - 数据库连接已关闭
2025-04-05 00:10:01.719 | INFO     | __main__:main:530 - 分析完成
2025-04-05 00:14:52.186 | INFO     | __main__:main:486 - 开始分析数据库...
2025-04-05 00:14:52.186 | INFO     | __main__:main:490 - 数据库路径: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-05 00:14:52.186 | INFO     | __main__:__init__:192 - 已连接到数据库: /Users/aladam/Desktop/langgraph-demo/data/account_data.db
2025-04-05 00:14:52.187 | INFO     | __main__:__init__:56 - 初始化DeepSeek-R1模型，API基础URL: https://api.siliconflow.cn/v1，模型: deepseek-ai/DeepSeek-R1
2025-04-05 00:14:52.187 | INFO     | __main__:__init__:269 - 初始化大模型分析器完成
2025-04-05 00:14:52.187 | INFO     | __main__:main:503 - 开始分析整个数据库...
2025-04-05 00:14:52.187 | INFO     | __main__:analyze_data:287 - 调用大模型API...
2025-04-05 00:14:52.187 | DEBUG    | __main__:generate:74 - API请求体: {'model': 'deepseek-ai/DeepSeek-R1', 'messages': [{'role': 'system', 'content': '你是一个专业的数据分析师，擅长分析数据库结构和内容，提供深入的见解。'}, {'role': 'user', 'content': '\n        请简要分析以下用水量数据，提供关键见解。请控制回复在300字以内。\n        \n        数据库名称: account_data.db\n        分析目标: 用水量数据分析\n        \n        用水量数据样本（每条记录代表一天的用水量）:\n        \n        请提供简要分析:\n        1. 用水量趋势是否正常\n        2. 根据连续几天的用水量数据，判断是否存在漏水迹象\n        \n        判断标准：\n        - 居民用水：正常情况下5天内用水量约1方以下；如果用量持续增加并超过3方可能是管道漏水；如果突然超过5方或连续每天都有0.5-1方用水可能是器具漏水\n        - 商业用水：正常情况下10天用水量约10-50方；如果当前用量较之前增大一倍可能存在漏水\n        \n        请保持简洁，控制回复在300字以内。\n        '}], 'temperature': 0.3, 'max_tokens': 800}
2025-04-05 00:14:52.187 | INFO     | __main__:generate:76 - 发送请求到DeepSeek API...
2025-04-05 00:15:41.915 | DEBUG    | __main__:generate:87 - API响应状态码: 200
2025-04-05 00:15:41.915 | DEBUG    | __main__:generate:88 - API响应内容: {"id":"019601956dcc73fb7dd2e6f3fde423f0","object":"chat.completion","created":1743783292,"model":"deepseek-ai/DeepSeek-R1","choices":[{"index":0,"message":{"role":"assistant","content":"【用水量分析简报】  \n**1. 用水趋势判断**  \n- **居民用户**：若连续5天用水量稳定在0.2-0.8方/天（累计≤1方），趋势正常；若出现连续3天以上超3方或单日突增超5方，需警惕管道/器具漏水。  \n- **商业用户**：10天内用水量在10-50方区间为正常；若日均量较历史翻倍（如从20方升至40方），可能漏水。  \n\n**2. 漏水风险检测**  \n- **管道漏水信号**：居民用水连续3天递增且总量超3方（如1.5→2.8→3.5方）。  \n- **器具漏水信号**：居民单日超5方（如马桶持续漏水）或连续多日稳定0.5-1方（如水龙头滴漏）。  \n- **商业漏水阈值**：日均量突破...
2025-04-05 00:15:41.915 | INFO     | __main__:generate:93 - 成功使用模型 deepseek-ai/DeepSeek-R1
2025-04-05 00:15:41.915 | INFO     | __main__:main:507 - 数据库分析成功
2025-04-05 00:15:41.916 | INFO     | __main__:main:513 - 分析报告已保存到: /Users/aladam/Desktop/langgraph-demo/database_analysis_report.md
2025-04-05 00:15:41.916 | INFO     | __main__:close:198 - 数据库连接已关闭
2025-04-05 00:15:41.916 | INFO     | __main__:main:534 - 分析完成
